<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>UkrMova Pro</title>
  <style>
    :root{--blue:#00a2ff;--red:#ff4d4d;--green:#2ecc71;--gold:#f1c40f;--dark:#d32f2f}
   
    body{
      margin:0;
      padding:0;
      background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)),
                  url('https://file.garden/aZHnP_3ch2qR4tWj/61faf7df-bcea-4915-be1f-680907b3eb8f.jpg') center/cover no-repeat fixed;
      color:#fff;
      font-family:sans-serif;
      min-height:100vh;
    }
   
    #splash{
      position:fixed;
      inset:0;
      z-index:9999;
      background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)),
                  url('https://file.garden/aZHnP_3ch2qR4tWj/61faf7df-bcea-4915-be1f-680907b3eb8f.jpg') center/cover no-repeat;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
    }
   
    #splash-video{
      width:100%;
      height:100%;
      object-fit:cover;
      position:absolute;
      top:0;
      left:0;
      opacity:1;
    }
   
    #startBtn{
      position:relative;
      z-index:10000;
      padding:24px 70px;
      font-size:36px;
      font-weight:bold;
      background:linear-gradient(45deg, #FFD700, #FFEA80);
      color:#00204A;
      border:4px solid #FFFFFF;
      border-radius:60px;
      cursor:pointer;
      box-shadow:0 10px 40px rgba(0,0,0,0.6);
      transition:all 0.4s ease;
    }
   
    #startBtn:hover{
      transform:scale(1.12) translateY(-6px);
      box-shadow:0 20px 60px rgba(255,215,0,0.95);
    }
   
    .screen{display:none;flex-direction:column;min-height:100vh;padding:20px;box-sizing:border-box}
    .active{display:flex}
    .card{
      background:rgba(255,255,255,0.88);
      backdrop-filter:blur(10px);
      padding:20px;
      border-radius:20px;
      border:1px solid #444;
      margin:auto;
      width:100%;
      max-width:300px;
      box-shadow:0 0 20px rgba(0,0,0,0.4);
      color:#000;
    }
    .btn{
      background:var(--blue);
      color:#fff;
      border:none;
      padding:14px;
      border-radius:12px;
      font-weight:700;
      width:100%;
      margin:6px 0;
      cursor:pointer;
      text-transform:uppercase;
      transition:all .2s;
    }
    .btn:hover{transform:scale(1.02);box-shadow:0 0 15px rgba(0,162,255,.6)}
    .btn.green{background:var(--green)}
    .btn.danger{background:var(--dark)}
    .money{font-size:32px;font-weight:900;color:var(--gold);text-shadow:0 0 10px #f1c40f}
    .nickname{font-size:28px;font-weight:bold;margin:10px 0;cursor:pointer}
    .gold-nick{color:var(--gold);text-shadow:0 0 10px var(--gold)}
    input{background:#f5f5f5;border:1px solid #444;padding:10px;border-radius:8px;color:#000;width:90%;margin-bottom:8px}
    .shop-item{background:#eee;padding:12px;margin:8px 0;border-radius:10px;cursor:pointer}
    .shop-item.bought{background:#c8e6c9}
    .shop-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    .theme-btn{background:#9c27b0;color:white}
    .log-box{max-height:220px;overflow-y:auto;border:1px solid #ccc;padding:10px;margin:10px 0;background:#f8f8f8;border-radius:8px}
    .log-entry{padding:4px 0;border-bottom:1px solid #eee}
    #admin-panel{border:2px dashed var(--red);padding:20px;margin-top:15px;display:none;background:rgba(255,255,255,0.92);text-align:left;border-radius:15px;max-height:80vh;overflow-y:auto}
    #feedback{text-align:center;font-size:48px;font-weight:bold;margin:20px 0;min-height:60px}
    .correct{color:#2ecc71}
    .wrong{color:#ff4d4d}
    .summary{font-size:24px;line-height:1.6;margin:30px 0;text-align:center}
    .summary strong{font-size:28px}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
  </style>
</head>
<body>

<div id="splash">
  <video id="splash-video" playsinline preload="auto" muted></video>
  <button id="startBtn">Почати гру</button>
</div>

<div id="auth-screen" class="screen">
  <div class="card">
    <h2 style="color:var(--gold)">UKRMOVA PRO</h2>
    <input type="text" id="nick" placeholder="Нікнейм" autocomplete="off">
    <input type="password" id="pass" placeholder="Пароль" autocomplete="off">
    <button class="btn" onclick="auth()">УВІЙТИ / ЗАРЕЄСТРУВАТИСЯ</button>
    <p id="auth-error" style="color:red; margin-top:10px; min-height:24px;"></p>
  </div>
</div>

<div id="menu" class="screen">
  <div class="card">
    <h3 onclick="admT()" style="cursor:pointer">МЕНЮ</h3>
    <div class="nickname" id="playerNick"></div>
    <div class="money"><span id="mon">0</span> ₴</div>
    <button class="btn" onclick="show('themes')">ГРАТИ</button>
    <button class="btn" style="background:#333" onclick="loadT()">ТОП</button>
    <button class="btn green" onclick="show('shop')">МАГАЗИН</button>
    <div id="admin-panel">
      <b style="color:var(--red);cursor:pointer;font-size:18px" onclick="closeAdm()">❌ ЗАКРИТИ АДМІНКУ</b><br><br>
      <button class="btn" id="pen-btn" style="background:var(--red)" onclick="toggleP()">ШТРАФИ: ВКЛ</button>
      <p><b>Управління гравцями</b></p>
      <input type="text" id="a-n" placeholder="Нік гравця">
      <button class="btn" style="background:var(--green);color:#000" onclick="edO(true)">+ ГРОШІ</button>
      <button class="btn" style="background:var(--red)" onclick="edO(false)">- ГРОШІ</button>
      <button class="btn danger" onclick="delU()">ВИДАЛИТИ ЗА НІКОМ</button>
      <br><br>
      <button class="btn" style="background:var(--blue);width:100%" onclick="loadPlayers()">ПОКАЗАТИ ВСІХ ГРАВЦІВ</button>
      <div id="player-list" style="max-height:250px;overflow-y:auto;margin:15px 0;background:#fff;padding:10px;border:1px solid #ccc;border-radius:8px"></div>
      <br><br>
      <h4 style="color:var(--blue)">Лог усіх входів у гру</h4>
      <div id="user-log" class="log-box">Завантаження...</div>
      <button class="btn" style="background:#ff9800;margin-top:8px;width:48%;margin-right:4%" onclick="loadUserLog()">Оновити</button>
      <button class="btn danger" style="margin-top:8px;width:48%" onclick="clearUserLog()">Очистити</button>
      <br><br>
      <h4 style="color:var(--blue)">Лог входів в адмінку</h4>
      <div id="admin-log" class="log-box">Завантаження...</div>
      <button class="btn" style="background:#ff9800;margin-top:8px;width:48%;margin-right:4%" onclick="loadAdminLogs()">Оновити</button>
      <button class="btn danger" style="margin-top:8px;width:48%" onclick="clearAdminLogs()">Очистити</button>
    </div>
  </div>
</div>

<div id="shop" class="screen">
  <div class="card">
    <h2>Магазин</h2>
    <div class="shop-grid">
      <div class="shop-item" onclick="buyItem('gold_frame')">Золота рамка — 1000 ₴</div>
      <div class="shop-item" onclick="buyItem('crown')">Корона — 2000 ₴</div>
      <div class="shop-item" onclick="buyItem('fire')">Полум'я — 1500 ₴</div>
      <div class="shop-item" onclick="buyItem('shield')">Щит — 2500 ₴</div>
      <div class="shop-item" onclick="buyItem('vip')">ВІП — 5000 ₴</div>
    </div>
    <button class="btn" onclick="show('menu')">НАЗАД</button>
  </div>
</div>

<div id="themes" class="screen">
  <div class="card">
    <h2>Обери розділ</h2>
    <button class="btn theme-btn" onclick="show('imennyky')">Іменники</button>
    <button class="btn theme-btn" onclick="show('prykmetnyky')">Прикметники</button>
    <button class="btn red" onclick="show('menu')">НАЗАД</button>
  </div>
</div>

<div id="imennyky" class="screen">
  <div class="card">
    <h2>Іменники</h2>
    <button class="btn theme-btn" onclick="startTheme('vydminy')">Відміни іменників</button>
    <button class="btn theme-btn" onclick="startTheme('orudnyi_1vidmina')">Орудний відмінок 1 відміни</button>
    <button class="btn red" onclick="show('themes')">НАЗАД</button>
  </div>
</div>

<div id="prykmetnyky" class="screen">
  <div class="card">
    <h2>Прикметники</h2>
    <button class="btn theme-btn" onclick="startTheme('prykmetnyky')">Прикметники</button>
    <button class="btn theme-btn" onclick="startTheme('grupy_prykmetnykiv')">Групи прикметників за значенням</button>
    <button class="btn theme-btn" onclick="startTheme('prykmetnyky_stupeni')">Ступені порівняння прикметників</button>
    <button class="btn theme-btn" onclick="startTheme('prykmetnyky_stupeni_2')">Ступені порівняння прикметників 2</button>
    <button class="btn theme-btn" onclick="startTheme('ne_z_prykmetnykamy')">Правопис НЕ з прикметниками</button>
    <button class="btn red" onclick="show('themes')">НАЗАД</button>
  </div>
</div>

<div id="game" class="screen">
  <div class="card">
    <h3 id="qtext"></h3>
    <div id="feedback"></div>
    <div id="abox"></div>
    <button class="btn red" style="margin-top:20px;" onclick="show('prykmetnyky')">НАЗАД</button>
  </div>
</div>

<div id="top" class="screen">
  <div class="card">
    <h3>ТОП 1000</h3>
    <div id="tlist">Завантаження...</div>
    <button class="btn" onclick="show('menu')">НАЗАД</button>
  </div>
</div>

<script>
// ================================================
// ГЛОБАЛЬНІ ЗМІННІ
// ================================================
const DB = "https://ukrmova-game-default-rtdb.europe-west1.firebasedatabase.app/";
let user = null;
let cC = 0;
let pOn = true;
let currentTheme = '';
let currentIndex = 0;
let correctCount = 0;
let wrongCount = 0;
let items = { gold_frame: false, crown: false, fire: false, shield: false, vip: false };
let currentCorrectAnswer = '';
const correctSound = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3");
const wrongSound = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3");

// ================================================
// ПОВНІ ТЕМИ / ЗАВДАННЯ
// ================================================
const themes = {
  vydminy: [
    {q:"До якої відміни належить слово «книга»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «стіл»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «мати»?", a:"третя відміна", w:["перша відміна","друга відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «ім'я»?", a:"четверта відміна", w:["перша відміна","друга відміна","третя відміна"]},
    {q:"До якої відміни належать іменники середнього роду на -о/-е?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «любов»?", a:"третя відміна", w:["перша відміна","друга відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «сіль»?", a:"третя відміна", w:["перша відміна","друга відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «серце»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «земля»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «день»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належать іменники жіночого роду на приголосний?", a:"третя відміна", w:["перша відміна","друга відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «дитина»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «вікно»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «тінь»?", a:"третя відміна", w:["перша відміна","друга відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «місто»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «кров»?", a:"третя відміна", w:["перша відміна","друга відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «дерево»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «мама»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «око»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «рука»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «пісня»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «море»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «гість»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «голова»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «яблуко»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «сестра»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «хліб»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «молодість»?", a:"третя відміна", w:["перша відміна","друга відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «сонце»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «вулиця»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «вітер»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «радість»?", a:"третя відміна", w:["перша відміна","друга відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «річка»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «ліс»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «теля»?", a:"четверта відміна", w:["перша відміна","третя відміна","друга відміна"]},
    {q:"До якої відміни належить слово «гора»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «поле»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «знання»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «дружба»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «будинок»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «мова»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «життя»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «людина»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «час»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «надія»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «вода»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «сон»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «плем'я»?", a:"четверта відміна", w:["перша відміна","друга відміна","третя відміна"]},
    {q:"До якої відміни належить слово «руки»?", a:"перша відміна", w:["друга відміна","третя відміна","четверта відміна"]},
    {q:"До якої відміни належить слово «очі»?", a:"друга відміна", w:["перша відміна","третя відміна","четверта відміна"]}
  ],
  prykmetnyky: [
    {q:"Який рід прикметника «гарна дівчина»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «велике поле»?", a:"середній рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «сильний чоловік»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «красива квітка»?", a:"жіночий рід", w:["середній рід"]},
    {q:"Який рід прикметника «нове авто»?", a:"середній рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «довга дорога»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «високий будинок»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «маленька дитина»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «старий дідусь»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «молодий хлопець»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «цікава книга»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «важке завдання»?", a:"середній рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «солодкий торт»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «гаряча кава»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «холодний лід»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «смачна піца»?", a:"жіночий рід", w:["середній рід"]},
    {q:"Який рід прикметника «сильна жінка»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «швидкий автомобіль»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «повільна черепаха»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «розумний хлопець»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «розумна дівчина»?", a:"жіночий рід", w:["середній рід"]},
    {q:"Який рід прикметника «веселий настрій»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «сумна пісня»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «добрий чоловік»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «злий собака»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «тепла погода»?", a:"жіночий рід", w:["середній рід"]},
    {q:"Який рід прикметника «холодне молоко»?", a:"середній рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «яскравий колір»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «темна ніч»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «світла кімната»?", a:"жіночий рід", w:["середній рід"]},
    {q:"Який рід прикметника «важлива справа»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «цікавий фільм»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «нудний урок»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «смішний жарт»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «серйозний чоловік»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «весела музика»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «сумна історія»?", a:"жіночий рід", w:["середній рід"]},
    {q:"Який рід прикметника «добре серце»?", a:"середній рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «зле око»?", a:"середній рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «новий рік»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «старе дерево»?", a:"середній рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «молоде покоління»?", a:"середній рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «висока гора»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «низький стіл»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «широкий шлях»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «вузька вулиця»?", a:"жіночий рід", w:["середній рід"]},
    {q:"Який рід прикметника «довге волосся»?", a:"середній рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «короткий шлях»?", a:"чоловічий рід", w:["жіночий рід"]}
  ],
  grupy_prykmetnykiv: [
    {q:"До якої групи за значенням належить прикметник «гарна» (гарна дівчина)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «дерев’яний» (дерев’яний стіл)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «мамина» (мамина сумка)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «залізний» (залізний характер)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «вовча» (вовча зграя)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «смачний» (смачний пиріг)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «батьків» (батьків дім)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «золотий» (золотий ланцюжок)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «розумний» (розумний хлопчик)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «сестрин» (сестрин зошит)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «зимовий» (зимовий вечір)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «гарячий» (гарячий чай)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «лисяча» (лисяча нора)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «високий» (високий чоловік)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «книжковий» (книжкова шафа)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «тітчин» (тітчин подарунок)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «солодкий» (солодкий мед)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «шкільний» (шкільний двір)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «дідусів» (дідусів годинник)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «красивий» (красивий краєвид)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «весняний» (весняний дощ)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «холодний» (холодний вітер)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «бабусин» (бабусин пиріг)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «металевий» (металевий міст)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «сильний» (сильний дощ)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «Ольжин» (Ольжин зошит)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «паперовий» (паперовий літак)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «веселий» (веселий настрій)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «ведмежа» (ведмежа берлога)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «цегляний» (цегляний будинок)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «теплий» (теплий вечір)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «Іванів» (Іванів велосипед)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «скляний» (скляний посуд)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «розумний» (розумний вчинок)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «собача» (собача будка)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «широкий» (широкий шлях)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «дитячий» (дитячий майданчик)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «чистий» (чисте небо)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «Петрів» (Петрів собака)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «пластиковий» (пластиковий стакан)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «сумний» (сумний погляд)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «вороняче» (вороняче гніздо)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «осінній» (осінній ліс)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «легкий» (легкий вітерець)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «мамине» (мамине плаття)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «мідний» (мідний таз)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «гордий» (гордий вигляд)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «золотий» (золота осінь – переносне значення)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «братів» (братів телефон)?", a:"присвійний", w:["якісний","відносний"]}
  ],
  orudnyi_1vidmina: [
    {q:"Орудний відмінок слова «книжка»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «душа»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «свіча»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «миша»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «Марія»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «тиша»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «зброя»?", a:"-ею", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «хімія»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «армія»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «сім'я»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «надія»?", a:"-ею", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «ідея»?", a:"-ею", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «лінія»?", a:"-ею", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «фотографія»?", a:"-ею", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «історія»?", a:"-ею", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «традиція»?", a:"-ею", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «революція»?", a:"-ею", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «станція»?", a:"-ею", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «вода»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «рука»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «річка»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «дорога»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «гора»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «дитина»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «сестра»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «школа»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «вулиця»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «пісня»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «голова»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «дівчина»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «квітка»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «зірка»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «машина»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «хвилина»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «акція»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «функція»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «секція»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «дискусія»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «екскурсія»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «конференція»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «організація»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «асоціація»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «нація»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «стаття»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «партія»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «компанія»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «фабрика»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «лабораторія»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «галерея»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «бібліотека»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «аптека»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «поліклініка»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «кухня»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «спальня»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «вітальня»?", a:"-ею", w:["-ою","-єю"]}
  ],
  prykmetnyky_stupeni: [
    { q: "найвеселіший — який це ступінь порівняння прикметника?", a: "найвищий", w: ["нульовий", "вищий"] },
    { q: "веселий — який це ступінь порівняння прикметника?", a: "нульовий", w: ["вищий", "найвищий"] },
    { q: "найрозумніший — який це ступінь порівняння прикметника?", a: "найвищий", w: ["нульовий", "вищий"] },
    { q: "тепліший — який це ступінь порівняння прикметника?", a: "вищий", w: ["нульовий", "найвищий"] },
    { q: "найглибший — який це ступінь порівняння прикметника?", a: "найвищий", w: ["нульовий", "вищий"] },
    { q: "найщасливіший — який це ступінь порівняння прикметника?", a: "найвищий", w: ["нульовий", "вищий"] },
    { q: "найцікавіший — який це ступінь порівняння прикметника?", a: "найвищий", w: ["нульовий", "вищий"] },
    { q: "веселіший — який це ступінь порівняння прикметника?", a: "вищий", w: ["нульовий", "найвищий"] },
    { q: "найсумніший — який це ступінь порівняння прикметника?", a: "найвищий", w: ["нульовий", "вищий"] },
    { q: "розумніший — який це ступінь порівняння прикметника?", a: "вищий", w: ["нульовий", "найвищий"] },
    { q: "сумніший — який це ступінь порівняння прикметника?", a: "вищий", w: ["нульовий", "найвищий"] },
    { q: "глибший — який це ступінь порівняння прикметника?", a: "вищий", w: ["нульовий", "найвищий"] },
    { q: "щасливіший — який це ступінь порівняння прикметника?", a: "вищий", w: ["нульовий", "найвищий"] },
    { q: "цікавіший — який це ступінь порівняння прикметника?", a: "вищий", w: ["нульовий", "найвищий"] },
    { q: "розумний — який це ступінь порівняння прикметника?", a: "нульовий", w: ["вищий", "найвищий"] },
    { q: "найтепліший — який це ступінь порівняння прикметника?", a: "найвищий", w: ["нульовий", "вищий"] },
    { q: "теплий — який це ступінь порівняння прикметника?", a: "нульовий", w: ["вищий", "найвищий"] },
    { q: "глибокий — який це ступінь порівняння прикметника?", a: "нульовий", w: ["вищий", "найвищий"] },
    { q: "щасливий — який це ступінь порівняння прикметника?", a: "нульовий", w: ["вищий", "найвищий"] },
    { q: "цікавий — який це ступінь порівняння прикметника?", a: "нульовий", w: ["вищий", "найвищий"] }
  ].sort(() => Math.random() - 0.5),
  prykmetnyky_stupeni_2: [
    {q:"Ця форма правильна: добріший?", a:"Так", w:["Так","Ні"]},
    {q:"Ця форма правильна: кращий?", a:"Так", w:["Так","Ні"]},
    {q:"Ця форма правильна: нижчий?", a:"Так", w:["Так","Ні"]},
    {q:"Ця форма правильна: дужчий?", a:"Так", w:["Так","Ні"]},
    {q:"Ця форма правильна: легший?", a:"Так", w:["Так","Ні"]},
    {q:"Ця форма правильна: найменш потрібний?", a:"Так", w:["Так","Ні"]},
    {q:"Ця форма правильна: більш важливий?", a:"Так", w:["Так","Ні"]},
    {q:"Ця форма правильна: менш стрімкий?", a:"Так", w:["Так","Ні"]},
    {q:"Ця форма правильна: радісніший?", a:"Так", w:["Так","Ні"]},
    {q:"Ця форма правильна: довший?", a:"Так", w:["Так","Ні"]},
    {q:"Ця форма правильна: більш смачний?", a:"Так", w:["Так","Ні"]},
    {q:"Ця форма правильна: швидкіший?", a:"Ні", w:["Так","Ні"]},
    {q:"Ця форма правильна: поганіший?", a:"Ні", w:["Так","Ні"]},
    {q:"Ця форма правильна: холодніший?", a:"Так", w:["Так","Ні"]},
    {q:"Ця форма правильна: менш рішучий?", a:"Так", w:["Так","Ні"]},
    {q:"Ця форма правильна: самий простіший?", a:"Ні", w:["Так","Ні"]},
    {q:"Ця форма правильна: блищий?", a:"Ні", w:["Так","Ні"]},
    {q:"Ця форма правильна: високіший?", a:"Ні", w:["Так","Ні"]},
    {q:"Ця форма правильна: ващий?", a:"Ні", w:["Так","Ні"]},
    {q:"Ця форма правильна: найбільш важливіший?", a:"Ні", w:["Так","Ні"]},
    {q:"Ця форма правильна: солодкіший?", a:"Ні", w:["Так","Ні"]},
    {q:"Ця форма правильна: менш веселіший?", a:"Ні", w:["Так","Ні"]},
    {q:"Ця форма правильна: більш вередливіший?", a:"Ні", w:["Так","Ні"]},
    {q:"Ця форма правильна: прекрасніший?", a:"Ні", w:["Так","Ні"]},
    {q:"Ця форма правильна: величезніший?", a:"Ні", w:["Так","Ні"]},
    {q:"Ця форма правильна: чорнявіший?", a:"Ні", w:["Так","Ні"]}
  ].sort(() => Math.random() - 0.5),
  ne_z_prykmetnykamy: [
    {q:"не/широка річка", a:"разом", w:["разом","окремо"]},
    {q:"не/солодкий апельсин", a:"разом", w:["разом","окремо"]},
    {q:"день не/довгий", a:"окремо", w:["разом","окремо"]},
    {q:"не/високий, а низький", a:"окремо", w:["разом","окремо"]},
    {q:"не/порушна дружба", a:"разом", w:["разом","окремо"]},
    {q:"не/вблаганна спека", a:"разом", w:["разом","окремо"]},
    {q:"будинок не/старий", a:"окремо", w:["разом","окремо"]},
    {q:"завдання зовсім не/складне", a:"окремо", w:["разом","окремо"]},
    {q:"не/щирий товариш", a:"разом", w:["разом","окремо"]},
    {q:"не/впинний рух", a:"разом", w:["разом","окремо"]},
    {q:"річка не/широка", a:"окремо", w:["разом","окремо"]},
    {q:"аж ніяк не/складний тест", a:"окремо", w:["разом","окремо"]},
    {q:"не/озорий степ", a:"разом", w:["разом","окремо"]},
    {q:"не/щира посмішка, а фальшива", a:"окремо", w:["разом","окремо"]}
  ].sort(() => Math.random() - 0.5)
};

// ================================================
// ЗАПУСК ВІДЕО
// ================================================
window.onload = function() {
  const splash = document.getElementById('splash');
  const video = document.getElementById('splash-video');
  const startBtn = document.getElementById('startBtn');
  video.src = "https://file.garden/aZHnP_3ch2qR4tWj/video_2026-02-14_17-15-12.mp4";
  startBtn.onclick = function() {
    startBtn.style.display = 'none';
    video.muted = false;
    video.currentTime = 0;
    video.play().then(() => {
      console.log("Відео успішно запущено зі звуком");
    }).catch(e => {
      console.error("Помилка відтворення відео:", e);
      alert("Не вдалося запустити відео. Спробуйте оновити сторінку.");
    });
  };
  video.onended = function() {
    console.log("Відео закінчилося → перехід до меню");
    splash.style.display = 'none';
    tryAutoLogin();
  };
  setTimeout(() => {
    if (splash.style.display !== 'none') {
      console.log("Запасний таймер спрацював — примусовий перехід");
      splash.style.display = 'none';
      tryAutoLogin();
    }
  }, 70000);
};

function tryAutoLogin() {
  const savedNick = localStorage.getItem('un');
  const savedPass = localStorage.getItem('up');
  if (savedNick && savedPass) {
    document.getElementById('nick').value = savedNick;
    document.getElementById('pass').value = savedPass;
    auth();
  } else {
    show('auth-screen');
  }
}

async function auth() {
  let n = document.getElementById('nick').value.trim();
  let p = document.getElementById('pass').value.trim();
  if(!n || !p) {
    document.getElementById('auth-error').textContent = "Введіть нікнейм та пароль";
    return;
  }
  document.getElementById('auth-error').textContent = "Завантаження...";
  try {
    let r = await fetch(DB + "users/" + n + ".json");
    let d = await r.json();
    if (d) {
      if (d.pass !== p) {
        document.getElementById('auth-error').textContent = "Неправильний пароль!";
        return;
      }
      user = d;
    } else {
      user = {name:n, pass:p, points:0, items:{gold_frame:false}};
      await fetch(DB + "users/" + n + ".json", {method:'PUT', body:JSON.stringify(user)});
    }
    localStorage.setItem('un', n);
    localStorage.setItem('up', p);
    const now = new Date().toLocaleString('uk-UA',{timeZone:'Europe/Kyiv'});
    await fetch(DB + "user_logs.json", {method:'POST',body:JSON.stringify({game_nick:n, time:now})});
    items = user.items || {gold_frame:false};
    save();
    applyItems();
    update();
    show('menu');
    document.getElementById('auth-error').textContent = "";
  } catch(e) {
    document.getElementById('auth-error').textContent = "Помилка підключення";
    console.error(e);
  }
}

function save() {
  user.items = items;
  fetch(DB + "users/" + user.name + ".json", {method:'PUT', body:JSON.stringify(user)});
}

function update() {
  document.getElementById('mon').innerText = user.points.toLocaleString();
}

function applyItems() {
  let nickDisplay = user.name;
  if(items.gold_frame) nickDisplay += ' <span class="gold-nick">[Золото]</span>';
  if(items.crown) nickDisplay += ' 👑';
  if(items.fire) nickDisplay += ' 🔥';
  if(items.shield) nickDisplay += ' 🛡️';
  if(items.vip) nickDisplay += ' 💎 VIP';
  document.getElementById('playerNick').innerHTML = nickDisplay;
}

function show(id) {
  document.querySelectorAll('.screen').forEach(s=>s.style.display='none');
  document.getElementById(id).style.display='block';
}

function admT() {
  if(++cC >= 5) {
    document.getElementById('admin-panel').style.display='block';
    logAdminAccess();
    loadAdminLogs();
    loadUserLog();
    cC = 0;
  }
}

async function logAdminAccess() {
  const now = new Date().toLocaleString('uk-UA', { timeZone: 'Europe/Kyiv' });
  const nick = user ? user.name : "Анонім";
  const entry = { nick: nick, time: now };
  await fetch(DB + "admin_logs.json", {
    method: 'POST',
    body: JSON.stringify(entry)
  });
}

function closeAdm() {
  document.getElementById('admin-panel').style.display='none';
  cC = 0;
}

function toggleP() {
  pOn = !pOn;
  document.getElementById('pen-btn').innerText = pOn ? "ШТРАФИ: ВКЛ" : "ШТРАФИ: ВИКЛ";
  document.getElementById('pen-btn').style.background = pOn ? "var(--red)" : "var(--green)";
}

async function delU() {
  let n = document.getElementById('a-n').value.trim();
  if(!n) return alert("Введіть нікнейм");
  if(confirm(`Видалити ${n}?`)) {
    await fetch(DB+"users/"+n+".json", {method:'DELETE'});
    alert("Видалено");
    loadPlayers();
  }
}

async function edO(add) {
  let n = document.getElementById('a-n').value.trim();
  if(!n) return alert("Введіть ник");
  let amt = prompt(add ? "Скільки додати?" : "Скільки відняти?");
  if(isNaN(amt) || amt <= 0) return alert("Невірна сума");
  amt = parseInt(amt);
  let r = await fetch(DB+"users/"+n+".json"), d = await r.json();
  if(!d) return alert("Гравця не знайдено");
  d.points += add ? amt : -amt;
  d.points = Math.max(0, d.points);
  await fetch(DB+"users/"+n+".json", {method:'PUT', body:JSON.stringify(d)});
  alert("Гроші оновлено");
  loadPlayers();
}

async function loadPlayers() {
  let r = await fetch(DB + "users/.json"), d = await r.json(), list = document.getElementById('player-list');
  list.innerHTML = '';
  if (!d || !Object.keys(d).length) {
    list.innerHTML = '<div style="padding:12px;color:#aaa">Гравців немає</div>';
    return;
  }
  for (let key in d) {
    let u = d[key];
    let displayNick = u.name || key;
    list.innerHTML += `
      <div style="padding:10px; border-bottom:1px solid #ddd; display:flex; justify-content:space-between; align-items:center;">
        <div>
          <strong>${displayNick}</strong><br>
          <small>Баланс: ${u.points || 0} ₴ | Пароль: ${u.pass || '—'}</small>
        </div>
      </div>
    `;
  }
}

async function loadUserLog() {
  try {
    let r = await fetch(DB + "user_logs.json");
    let data = await r.json();
    let logDiv = document.getElementById('user-log');
    logDiv.innerHTML = '';
    if (data) {
      Object.values(data).reverse().slice(0,100).forEach(entry => {
        logDiv.innerHTML += `<div class="log-entry">${entry.time} — <b>${entry.game_nick}</b></div>`;
      });
    } else {
      logDiv.innerHTML = 'Лог порожній';
    }
  } catch (e) {
    document.getElementById('user-log').innerHTML = 'Помилка завантаження';
  }
}

async function clearUserLog() {
  if (!confirm("Очистити лог усіх входів?")) return;
  await fetch(DB + "user_logs.json", {method: 'DELETE'});
  loadUserLog();
  alert("Лог входів очищено");
}

async function loadAdminLogs() {
  try {
    let r = await fetch(DB + "admin_logs.json");
    let data = await r.json();
    let logDiv = document.getElementById('admin-log');
    logDiv.innerHTML = '';
    if (data && Object.keys(data).length > 0) {
      Object.values(data).reverse().forEach(log => {
        logDiv.innerHTML += `<div class="log-entry">${log.time} — <b>${log.nick}</b></div>`;
      });
    } else {
      logDiv.innerHTML = 'Лог порожній';
    }
  } catch (e) {
    document.getElementById('admin-log').innerHTML = 'Помилка завантаження логу';
  }
}

async function clearAdminLogs() {
  if (!confirm("Очистити лог адмінки?")) return;
  await fetch(DB + "admin_logs.json", {method: 'DELETE'});
  loadAdminLogs();
  alert("Лог адмінки очищено");
}

function startTheme(theme) {
  currentTheme = theme;
  currentIndex = 0;
  correctCount = 0;
  wrongCount = 0;
  show('game');
  loadQuestion();
}

function loadQuestion() {
  const qs = themes[currentTheme];
  if (currentIndex >= qs.length) {
    document.getElementById('qtext').textContent = "Тема завершена!";
    document.getElementById('feedback').innerHTML = '';
    document.getElementById('abox').innerHTML = `
      <div class="summary">
        <strong>Гравець:</strong> ${user ? user.name : '—'}<br><br>
        <strong style="color:var(--green)">Правильних відповідей:</strong> ${correctCount}<br>
        <strong style="color:var(--red)">Неправильних відповідей:</strong> ${wrongCount}<br><br>
        <strong>Поточний баланс:</strong> ${user ? user.points.toLocaleString() : 0} ₴
      </div>
      <button class="btn" onclick="show('prykmetnyky')">Обрати іншу тему</button>
    `;
    save();
    return;
  }
  const q = qs[currentIndex];
  currentCorrectAnswer = q.a;
  document.getElementById('qtext').textContent = `Питання ${currentIndex+1}/${qs.length}: ${q.q}`;
  document.getElementById('feedback').innerHTML = '';
  const abox = document.getElementById('abox');
  abox.innerHTML = '';

  // Спеціальна логіка для теми "Ступені порівняння прикметників 2" — ТІЛЬКИ ДВА ВАРІАНТИ: Так / Ні
  if (currentTheme === 'prykmetnyky_stupeni_2') {
    ["Так", "Ні"].forEach(o => {
      let btn = document.createElement('button');
      btn.className = 'btn';
      btn.innerText = o;
      btn.onclick = () => checkAnswer(o, q.a, btn);
      abox.appendChild(btn);
    });
  } else if (currentTheme === 'ne_z_prykmetnykamy') {
    ["разом", "окремо"].forEach(o => {
      let btn = document.createElement('button');
      btn.className = 'btn';
      btn.innerText = o.toUpperCase();
      btn.onclick = () => checkAnswer(o, q.a, btn);
      abox.appendChild(btn);
    });
  } else {
    // звичайна логіка для всіх інших тем
    let answers = [q.a, ...q.w];
    answers.sort(() => Math.random() - 0.5);
    answers.forEach(o => {
      let btn = document.createElement('button');
      btn.className = 'btn';
      btn.innerText = o;
      btn.onclick = () => checkAnswer(o, q.a, btn);
      abox.appendChild(btn);
    });
  }
}

function checkAnswer(selected, correct, button) {
  document.querySelectorAll('#abox .btn').forEach(b => b.disabled = true);
  if (selected === correct) {
    correctCount++;
    user.points += 100;
    button.style.background = 'var(--green)';
    button.style.color = 'white';
    document.getElementById('feedback').innerHTML = '<span class="correct">ПРАВИЛЬНО!</span>';
    correctSound.currentTime = 0;
    correctSound.play().catch(()=>{});
  } else {
    wrongCount++;
    user.points = Math.max(0, user.points - 30);
    button.style.background = 'var(--red)';
    button.style.color = 'white';
    document.getElementById('feedback').innerHTML = '<span class="wrong">❌</span>';
    wrongSound.currentTime = 0;
    wrongSound.play().catch(()=>{});
  }
  document.getElementById('mon').innerText = user.points.toLocaleString();
  save();
  setTimeout(() => {
    currentIndex++;
    loadQuestion();
  }, 1000);
}

async function loadT() {
  show('top');
  let r = await fetch(DB+"users/.json"), d = await r.json();
  let l = document.getElementById('tlist');
  l.innerHTML = '';
  if(d) {
    let topPlayers = Object.values(d).sort((a,b)=> (b.points||0) - (a.points||0)).slice(0,1000);
    topPlayers.forEach((u,i) => {
      l.innerHTML += `<div style="display:flex;justify-content:space-between;padding:8px">
        <span>${i+1}. ${u.name}</span><b>${u.points||0}</b>
      </div>`;
    });
  } else {
    l.innerHTML = '<div style="padding:12px;color:#aaa">Топ порожній</div>';
  }
}

function buyItem(item) {
  const prices = {gold_frame:1000, crown:2000, fire:1500, shield:2500, vip:5000};
  if(user.points >= prices[item]){
    user.points -= prices[item];
    items[item] = true;
    applyItems();
    save(); update();
    alert("Куплено: " + item);
  } else alert("Недостатньо грошей!");
}
</script>
</body>
</html>
