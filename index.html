<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>UkrMova Pro</title>
<style>
:root{--blue:#00a2ff;--red:#ff4d4d;--green:#2ecc71;--gold:#f1c40f;--dark:#d32f2f}
body{margin:0;padding:0;font-family:sans-serif;color:#000;background:url('https://upload.wikimedia.org/wikipedia/commons/thumb/4/49/Flag_of_Ukraine.svg/2560px-Flag_of_Ukraine.svg.png') no-repeat center center fixed;background-size:cover;min-height:100vh;position:relative}
body::before{content:"";position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(255,255,255,0.75);z-index:-2}
.screen{display:none;padding:20px;flex-direction:column;min-height:100vh;box-sizing:border-box;position:relative;z-index:1}
.active{display:flex;animation:fadeIn .3s ease}
.card{background:rgba(255,255,255,0.92);backdrop-filter:blur(10px);padding:20px;border-radius:20px;border:1px solid #444;margin:auto;width:100%;max-width:450px;box-shadow:0 0 20px rgba(0,0,0,0.3);position:relative;z-index:2}
.btn{background:var(--blue);color:#fff;border:none;padding:14px;border-radius:12px;font-weight:700;width:100%;margin:6px 0;cursor:pointer;text-transform:uppercase;transition:all .2s}
.btn:hover{transform:scale(1.02);box-shadow:0 0 15px rgba(0,162,255,.6)}
.btn.green{background:var(--green)}
.btn.danger{background:var(--dark)}
.money{font-size:32px;font-weight:900;color:var(--gold);text-shadow:0 0 10px #f1c40f}
.nickname{font-size:28px;font-weight:bold;margin:10px 0;cursor:pointer}
.gold-nick{color:var(--gold);text-shadow:0 0 10px var(--gold)}
.lvl-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;max-height:40vh;overflow-y:auto;padding:10px}
.lvl{background:rgba(51,51,51,0.7);padding:12px 0;border-radius:10px;opacity:0.6;transition:all .3s;border:1px solid #ccc}
.lvl.open{opacity:1;background:var(--blue);border:2px solid white;box-shadow:0 0 15px var(--blue);color:white}
#admin-panel{border:2px dashed var(--red);padding:15px;margin-top:15px;display:none;background:rgba(255,255,255,0.92);text-align:left;border-radius:15px}
input{background:#f5f5f5;border:1px solid #444;padding:10px;border-radius:8px;color:#000;width:90%;margin-bottom:8px}
.shop-item{background:#eee;padding:12px;margin:8px 0;border-radius:10px;cursor:pointer}
.shop-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
.theme-btn{background:#9c27b0;color:white}
.log-box{max-height:220px;overflow-y:auto;border:1px solid #ccc;padding:10px;margin:10px 0;background:#f8f8f8;border-radius:8px}
.log-entry{padding:4px 0;border-bottom:1px solid #eee}
#bot-chat-box{max-height:300px;overflow-y:auto;border:1px solid #ccc;padding:15px;margin:15px 0;background:rgba(255,255,255,0.8);border-radius:10px}
.bot-msg{padding:10px;margin:8px 0;background:#e3f2fd;border-radius:10px;max-width:80%}
#bot-chat-input{display:flex;gap:10px;margin-top:10px}
#bot-chat-input input{flex:1;padding:10px;border:1px solid #ccc;border-radius:8px}
#bot-chat-input button{padding:10px 20px}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
</style>
</head>
<body>

<div id="auth-screen" class="screen active">
  <div class="card">
    <h2 style="color:var(--gold)">UKRMOVA PRO</h2>
    <input type="text" id="nick" placeholder="–ù—ñ–∫–Ω–µ–π–º">
    <input type="password" id="pass" placeholder="–ü–∞—Ä–æ–ª—å">
    <button class="btn" onclick="auth()">–£–í–Ü–ô–¢–ò</button>
  </div>
</div>

<div id="menu" class="screen">
  <div class="card">
    <h3 onclick="admT()" style="cursor:pointer">–ú–ï–ù–Æ</h3>
    <div class="nickname" id="playerNick"></div>
    <div class="money"><span id="mon">0</span> ‚Ç¥</div>

    <button class="btn" onclick="showThemes()">–ì–†–ê–¢–ò</button>
    <button class="btn" style="background:#333" onclick="loadT()">–¢–û–ü</button>
    <button class="btn green" onclick="show('shop')">–ú–ê–ì–ê–ó–ò–ù</button>

    <h4 style="color:var(--blue)">–ß–∞—Ç –≤—ñ–¥ –±–æ—Ç–∞</h4>
    <div id="bot-chat-box"></div>

    <div id="admin-panel">
      <b style="color:var(--red);cursor:pointer" onclick="closeAdm()">‚ùå –ó–ê–ö–†–ò–¢–ò</b><br><br>
      <button class="btn" id="pen-btn" style="background:var(--red)" onclick="toggleP()">–®–¢–†–ê–§–ò: –í–ö–õ</button>

      <p><b>–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≥—Ä–∞–≤—Ü—è–º–∏</b></p>
      <input type="text" id="a-n" placeholder="–ù—ñ–∫ –≥—Ä–∞–≤—Ü—è">
      <button class="btn" style="background:var(--green);color:#000" onclick="edO(true)">+ –ì–†–û–®–Ü</button>
      <button class="btn" style="background:var(--red)" onclick="edO(false)">- –ì–†–û–®–Ü</button>
      <button class="btn danger" onclick="delU()">–í–ò–î–ê–õ–ò–¢–ò –ó–ê –ù–Ü–ö–û–ú</button>

      <br><br>
      <button class="btn" style="background:var(--blue);width:100%" onclick="loadPlayers()">–ü–û–ö–ê–ó–ê–¢–ò –í–°–Ü–• –ì–†–ê–í–¶–Ü–í</button>

      <div id="player-list" style="max-height:250px;overflow-y:auto;margin:15px 0;background:#fff;padding:10px;border:1px solid #ccc;border-radius:8px"></div>

      <br><br>
      <h4 style="color:var(--blue)">–õ–æ–≥ –≤—Ö–æ–¥—ñ–≤ –≤ –∞–¥–º—ñ–Ω–∫—É</h4>
      <div id="admin-log" class="log-box">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
      <button class="btn" style="background:#ff9800" onclick="clearAdminLogs()">–û—á–∏—Å—Ç–∏—Ç–∏ –ª–æ–≥ –∞–¥–º—ñ–Ω–∫–∏</button>

      <br><br>
      <h4 style="color:var(--blue)">–õ–æ–≥ —É—Å—ñ—Ö –≤—Ö–æ–¥—ñ–≤ —É –≥—Ä—É</h4>
      <div id="user-log" class="log-box">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
      <button class="btn" style="background:#ff9800;margin-top:8px" onclick="loadUserLog()">–û–Ω–æ–≤–∏—Ç–∏</button>
      <button class="btn danger" style="margin-top:8px" onclick="clearUserLog()">–û—á–∏—Å—Ç–∏—Ç–∏</button>

      <br><br>
      <h4 style="color:var(--blue)">–ù–∞–ø–∏—Å–∞—Ç–∏ –≤—ñ–¥ —ñ–º–µ–Ω—ñ –±–æ—Ç–∞ (–≤—Å—ñ–º)</h4>
      <div id="bot-chat-input">
        <input type="text" id="bot-message" placeholder="–¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è...">
        <button class="btn" onclick="sendBotMessage()">–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏</button>
      </div>
    </div>
  </div>
</div>

<div id="shop" class="screen">
  <div class="card">
    <h2>–ú–∞–≥–∞–∑–∏–Ω</h2>
    <div class="shop-grid">
      <div class="shop-item" id="gold_frame" onclick="buyItem('gold_frame')">–ó–æ–ª–æ—Ç–∞ —Ä–∞–º–∫–∞ ‚Äî 1000 ‚Ç¥</div>
      <div class="shop-item" id="crown" onclick="buyItem('crown')">–ö–æ—Ä–æ–Ω–∞ ‚Äî 2000 ‚Ç¥</div>
      <div class="shop-item" id="fire" onclick="buyItem('fire')">–ü–æ–ª—É–º'—è ‚Äî 1500 ‚Ç¥</div>
      <div class="shop-item" id="shield" onclick="buyItem('shield')">–©–∏—Ç ‚Äî 2500 ‚Ç¥</div>
      <div class="shop-item" id="vip" onclick="buyItem('vip')">–í–Ü–ü ‚Äî 5000 ‚Ç¥</div>
    </div>
    <button class="btn" onclick="show('menu')">–ù–ê–ó–ê–î</button>
  </div>
</div>

<div id="themes" class="screen">
  <div class="card">
    <h2>–û–±–µ—Ä–∏ —Ç–µ–º—É</h2>
    <button class="btn theme-btn" onclick="startTheme('vydminy')">–í—ñ–¥–º—ñ–Ω–∏ —ñ–º–µ–Ω–Ω–∏–∫—ñ–≤</button>
    <button class="btn theme-btn" onclick="startTheme('chasyslova')">–ß–∞—Å–∏ –¥—ñ—î—Å–ª—ñ–≤</button>
    <button class="btn theme-btn" onclick="startTheme('prykmetnyky')">–ü—Ä–∏–∫–º–µ—Ç–Ω–∏–∫–∏</button>
    <button class="btn theme-btn" onclick="startTheme('pryslinniky')">–ü—Ä–∏—Å–ª—ñ–≤–Ω–∏–∫–∏</button>
    <button class="btn theme-btn" onclick="startTheme('synonimy')">–°–∏–Ω–æ–Ω—ñ–º–∏ / –ê–Ω—Ç–æ–Ω—ñ–º–∏</button>
    <button class="btn red" onclick="show('menu')">–ù–ê–ó–ê–î</button>
  </div>
</div>

<div id="levels" class="screen"><div class="card"><h3>–†–Ü–í–ù–Ü</h3><div class="lvl-grid" id="lgrid"></div><button class="btn" onclick="show('menu')">–ù–ê–ó–ê–î</button></div></div>
<div id="game" class="screen"><div class="card"><h3 id="qtext"></h3><div id="abox"></div></div></div>
<div id="top" class="screen"><div class="card"><h3>–¢–û–ü 1000</h3><div id="tlist"></div><button class="btn" onclick="show('menu')">–ù–ê–ó–ê–î</button></div></div>

<script>
const DB = "https://ukrmova-game-default-rtdb.europe-west1.firebasedatabase.app/";
let user = null, cC = 0, pOn = true, customQ = [], usedQuestions = new Set();
let items = { gold_frame: false, crown: false, fire: false, shield: false, vip: false };
let currentTheme = '';

const correctSound = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3");
const wrongSound = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3");

document.addEventListener('click', () => {
  correctSound.play().catch(()=>{});
  wrongSound.play().catch(()=>{});
}, {once: true});

window.onload = () => {
  if(localStorage.getItem('un')) document.getElementById('nick').value = localStorage.getItem('un');
  if(localStorage.getItem('up')) document.getElementById('pass').value = localStorage.getItem('up');
};

const base = [
  {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–∫–Ω–∏–≥–∞¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
  {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—Å—Ç—ñ–ª¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
  {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–Ω—ñ—á¬ª?",cor:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞",inc:"—á–µ—Ç–≤–µ—Ä—Ç–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
  {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–ø–æ–ª–µ¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
  {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∞—Ç—å —ñ–º–µ–Ω–Ω–∏–∫–∏ –∂—ñ–Ω–æ—á–æ–≥–æ —Ä–æ–¥—É –Ω–∞ -–∞/-—è?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞"}
];

const themes = {
  vydminy: [
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–∫–Ω–∏–≥–∞¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—Å—Ç—ñ–ª¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–º–∞—Ç–∏¬ª?",cor:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—ñ–º'—è¬ª?",cor:"—á–µ—Ç–≤–µ—Ä—Ç–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∞—Ç—å —ñ–º–µ–Ω–Ω–∏–∫–∏ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ —Ä–æ–¥—É –Ω–∞ -–æ/-–µ?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–ª—é–±–æ–≤¬ª?",cor:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞",inc:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—Å—ñ–ª—å¬ª?",cor:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞",inc:"—á–µ—Ç–≤–µ—Ä—Ç–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—Å–µ—Ä—Ü–µ¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–∑–µ–º–ª—è¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–¥–µ–Ω—å¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∞—Ç—å —ñ–º–µ–Ω–Ω–∏–∫–∏ –∂—ñ–Ω–æ—á–æ–≥–æ —Ä–æ–¥—É –Ω–∞ –ø—Ä–∏–≥–æ–ª–æ—Å–Ω–∏–π?",cor:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–¥–∏—Ç–∏–Ω–∞¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–≤—ñ–∫–Ω–æ¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—Ç—ñ–Ω—å¬ª?",cor:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–º—ñ—Å—Ç–æ¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–∫—Ä–æ–≤¬ª?",cor:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞",inc:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–¥–µ—Ä–µ–≤–æ¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–º–∞–º–∞¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–æ–∫–æ¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—Ä—É–∫–∞¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–ø—ñ—Å–Ω—è¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–º–æ—Ä–µ¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–≥—ñ—Å—Ç—å¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–≥–æ–ª–æ–≤–∞¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—è–±–ª—É–∫–æ¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—Å–µ—Å—Ç—Ä–∞¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—Ö–ª—ñ–±¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–º–æ–ª–æ–¥—ñ—Å—Ç—å¬ª?",cor:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—Å–æ–Ω—Ü–µ¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–≤—É–ª–∏—Ü—è¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–≤—ñ—Ç–µ—Ä¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—Ä–∞–¥—ñ—Å—Ç—å¬ª?",cor:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—Ä—ñ—á–∫–∞¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–ª—ñ—Å¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–¥–≤–µ—Ä—ñ¬ª?",cor:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞",inc:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–≥–æ—Ä–∞¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–ø–æ–ª–µ¬ª —É –º–Ω–æ–∂–∏–Ω—ñ?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–∑–Ω–∞–Ω–Ω—è¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–¥—Ä—É–∂–±–∞¬ª?",cor:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–±—É–¥–∏–Ω–æ–∫¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–º–æ–≤–∞¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–∂–∏—Ç—Ç—è¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–ª—é–¥–∏–Ω–∞¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—á–∞—Å¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–Ω–∞–¥—ñ—è¬ª?",cor:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞",inc:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–≤–æ–¥–∞¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—Å–æ–Ω¬ª?",cor:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–Ω—ñ—á¬ª —É –º–Ω–æ–∂–∏–Ω—ñ?",cor:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞",inc:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´—Ä—É–∫–∏¬ª?",cor:"–ø–µ—Ä—à–∞ –≤—ñ–¥–º—ñ–Ω–∞",inc:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞"},
    {t:"–î–æ —è–∫–æ—ó –≤—ñ–¥–º—ñ–Ω–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Å–ª–æ–≤–æ ¬´–æ—á—ñ¬ª?",cor:"—Ç—Ä–µ—Ç—è –≤—ñ–¥–º—ñ–Ω–∞",inc:"–¥—Ä—É–≥–∞ –≤—ñ–¥–º—ñ–Ω–∞"}
  ],
  chasyslova: [
    {t:"–Ø–∫–∏–π —á–∞—Å –¥—ñ—î—Å–ª–æ–≤–∞ ¬´—á–∏—Ç–∞—Ç–∏¬ª —É —Ä–µ—á–µ–Ω–Ω—ñ ¬´–Ø —á–∏—Ç–∞–≤ –∫–Ω–∏–≥—É¬ª?",cor:"–º–∏–Ω—É–ª–∏–π —á–∞—Å",inc:"—Ç–µ–ø–µ—Ä—ñ—à–Ω—ñ–π —á–∞—Å"},
    {t:"–Ø–∫–∏–π —á–∞—Å –¥—ñ—î—Å–ª–æ–≤–∞ ¬´–ø–∏—Å–∞—Ç–∏¬ª —É —Ä–µ—á–µ–Ω–Ω—ñ ¬´–í—ñ–Ω –ø–∏—à–µ –ª–∏—Å—Ç–∞¬ª?",cor:"—Ç–µ–ø–µ—Ä—ñ—à–Ω—ñ–π —á–∞—Å",inc:"–º–∞–π–±—É—Ç–Ω—ñ–π —á–∞—Å"},
    {t:"–Ø–∫–∏–π —á–∞—Å –¥—ñ—î—Å–ª–æ–≤–∞ ¬´–π—Ç–∏¬ª —É —Ä–µ—á–µ–Ω–Ω—ñ ¬´–Ø –π–¥—É –¥–æ–¥–æ–º—É¬ª?",cor:"—Ç–µ–ø–µ—Ä—ñ—à–Ω—ñ–π —á–∞—Å",inc:"–º–∏–Ω—É–ª–∏–π —á–∞—Å"},
    {t:"–Ø–∫–∏–π —á–∞—Å –¥—ñ—î—Å–ª–æ–≤–∞ ¬´–±—É–¥—É–≤–∞—Ç–∏¬ª —É —Ä–µ—á–µ–Ω–Ω—ñ ¬´–ú–∏ –ø–æ–±—É–¥—É—î–º–æ –±—É–¥–∏–Ω–æ–∫¬ª?",cor:"–º–∞–π–±—É—Ç–Ω—ñ–π —á–∞—Å",inc:"–º–∏–Ω—É–ª–∏–π —á–∞—Å"},
    {t:"–Ø–∫–∏–π —á–∞—Å –¥—ñ—î—Å–ª–æ–≤–∞ ¬´—Å–ø—ñ–≤–∞—Ç–∏¬ª —É —Ä–µ—á–µ–Ω–Ω—ñ ¬´–í–æ–Ω–∞ —Å–ø—ñ–≤–∞–ª–∞ –ø—ñ—Å–Ω—é¬ª?",cor:"–º–∏–Ω—É–ª–∏–π —á–∞—Å",inc:"—Ç–µ–ø–µ—Ä—ñ—à–Ω—ñ–π —á–∞—Å"},
    {t:"–Ø–∫–∏–π —á–∞—Å –¥—ñ—î—Å–ª–æ–≤–∞ ¬´–≥–æ–≤–æ—Ä–∏—Ç–∏¬ª —É —Ä–µ—á–µ–Ω–Ω—ñ ¬´–í–æ–Ω–∏ –≥–æ–≤–æ—Ä—è—Ç—å —à–≤–∏–¥–∫–æ¬ª?",cor:"—Ç–µ–ø–µ—Ä—ñ—à–Ω—ñ–π —á–∞—Å",inc:"–º–∞–π–±—É—Ç–Ω—ñ–π —á–∞—Å"},
    {t:"–Ø–∫–∏–π —á–∞—Å –¥—ñ—î—Å–ª–æ–≤–∞ ¬´—ó—Å—Ç–∏¬ª —É —Ä–µ—á–µ–Ω–Ω—ñ ¬´–Ø —ó–≤ –±–æ—Ä—â¬ª?",cor:"–º–∏–Ω—É–ª–∏–π —á–∞—Å",inc:"—Ç–µ–ø–µ—Ä—ñ—à–Ω—ñ–π —á–∞—Å"},
    {t:"–Ø–∫–∏–π —á–∞—Å –¥—ñ—î—Å–ª–æ–≤–∞ ¬´–¥–∏–≤–∏—Ç–∏—Å—è¬ª —É —Ä–µ—á–µ–Ω–Ω—ñ ¬´–ú–∏ –±—É–¥–µ–º–æ –¥–∏–≤–∏—Ç–∏—Å—è —Ñ—ñ–ª—å–º¬ª?",cor:"–º–∞–π–±—É—Ç–Ω—ñ–π —á–∞—Å",inc:"–º–∏–Ω—É–ª–∏–π —á–∞—Å"},
    {t:"–Ø–∫–∏–π —á–∞—Å –¥—ñ—î—Å–ª–æ–≤–∞ ¬´–º–∞–ª—é–≤–∞—Ç–∏¬ª —É —Ä–µ—á–µ–Ω–Ω—ñ ¬´–î–∏—Ç–∏–Ω–∞ –º–∞–ª—é—î¬ª?",cor:"—Ç–µ–ø–µ—Ä—ñ—à–Ω—ñ–π —á–∞—Å",inc:"–º–∏–Ω—É–ª–∏–π —á–∞—Å"},
    {t:"–Ø–∫–∏–π —á–∞—Å –¥—ñ—î—Å–ª–æ–≤–∞ ¬´–≥—Ä–∞—Ç–∏¬ª —É —Ä–µ—á–µ–Ω–Ω—ñ ¬´–í—ñ–Ω –≥—Ä–∞–≤ —É —Ñ—É—Ç–±–æ–ª¬ª?",cor:"–º–∏–Ω—É–ª–∏–π —á–∞—Å",inc:"–º–∞–π–±—É—Ç–Ω—ñ–π —á–∞—Å"}
  ],
  prykmetnyky: [
    {t:"–Ø–∫–∏–π —Ä—ñ–¥ –ø—Ä–∏–∫–º–µ—Ç–Ω–∏–∫–∞ ¬´–≥–∞—Ä–Ω–∏–π¬ª —É —Ä–µ—á–µ–Ω–Ω—ñ ¬´–≥–∞—Ä–Ω–∞ –¥—ñ–≤—á–∏–Ω–∞¬ª?",cor:"–∂—ñ–Ω–æ—á–∏–π —Ä—ñ–¥",inc:"—á–æ–ª–æ–≤—ñ—á–∏–π —Ä—ñ–¥"},
    {t:"–Ø–∫–∏–π —Ä—ñ–¥ –ø—Ä–∏–∫–º–µ—Ç–Ω–∏–∫–∞ ¬´–≤–µ–ª–∏–∫–∏–π¬ª —É —Ä–µ—á–µ–Ω–Ω—ñ ¬´–≤–µ–ª–∏–∫–µ –ø–æ–ª–µ¬ª?",cor:"—Å–µ—Ä–µ–¥–Ω—ñ–π —Ä—ñ–¥",inc:"–∂—ñ–Ω–æ—á–∏–π —Ä—ñ–¥"},
    {t:"–Ø–∫–∏–π —Ä—ñ–¥ –ø—Ä–∏–∫–º–µ—Ç–Ω–∏–∫–∞ ¬´—Å–∏–ª—å–Ω–∏–π¬ª —É —Ä–µ—á–µ–Ω–Ω—ñ ¬´—Å–∏–ª—å–Ω–∏–π —á–æ–ª–æ–≤—ñ–∫¬ª?",cor:"—á–æ–ª–æ–≤—ñ—á–∏–π —Ä—ñ–¥",inc:"–∂—ñ–Ω–æ—á–∏–π —Ä—ñ–¥"}
  ],
  pryslinniky: [
    {t:"–Ø–∫–∏–π –ø—Ä–∏—Å–ª—ñ–≤–Ω–∏–∫ —á–∞—Å—É –≤ —Ä–µ—á–µ–Ω–Ω—ñ ¬´–í—á–æ—Ä–∞ —è –±—É–≤ —É –∫—ñ–Ω–æ¬ª?",cor:"–≤—á–æ—Ä–∞",inc:"–∑–∞–≤—Ç—Ä–∞"},
    {t:"–Ø–∫–∏–π –ø—Ä–∏—Å–ª—ñ–≤–Ω–∏–∫ –º—ñ—Å—Ü—è –≤ —Ä–µ—á–µ–Ω–Ω—ñ ¬´–¢–∞–º —Å—Ç–æ—ó—Ç—å —Å—Ç—ñ–ª¬ª?",cor:"—Ç–∞–º",inc:"—Ç—É—Ç"}
  ],
  synonimy: [
    {t:"–°–∏–Ω–æ–Ω—ñ–º –¥–æ —Å–ª–æ–≤–∞ ¬´–≤–µ–ª–∏–∫–∏–π¬ª?",cor:"–æ–≥—Ä–æ–º–Ω–∏–π",inc:"–º–∞–ª–µ–Ω—å–∫–∏–π"},
    {t:"–ê–Ω—Ç–æ–Ω—ñ–º –¥–æ —Å–ª–æ–≤–∞ ¬´—à–≤–∏–¥–∫–æ¬ª?",cor:"–ø–æ–≤—ñ–ª—å–Ω–æ",inc:"—à–≤–∏–¥–∫–æ"}
  ]
};

async function auth() {
  let n = document.getElementById('nick').value.trim(), p = document.getElementById('pass').value.trim();
  if(!n || !p) return alert("–í–≤–µ–¥—ñ—Ç—å –Ω—ñ–∫–Ω–µ–π–º —Ç–∞ –ø–∞—Ä–æ–ª—å");
  localStorage.setItem('un', n); localStorage.setItem('up', p);

  const tg = window.Telegram?.WebApp?.initDataUnsafe?.user || {username:"–Ω–µ–º–∞—î",id:"–Ω–µ–º–∞—î"};
  const now = new Date().toLocaleString('uk-UA',{timeZone:'Europe/Kyiv'});
  const entry = {game_nick:n,tg_username:tg.username||"–Ω–µ–º–∞—î",tg_id:tg.id||"–Ω–µ–º–∞—î",time:now};
  await fetch(DB + "user_logs.json", {method:'POST',body:JSON.stringify(entry)});

  let r = await fetch(DB+"users/"+n+".json"), d = await r.json();
  user = d || {name:n, pass:p, points:0, lvl:1, items:{gold_frame:false}};
  if(d && d.pass !== p) return alert("–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø–∞—Ä–æ–ª—å!");
  items = user.items || {gold_frame:false};
  save(); applyItems(); update(); show('menu');
}

function save() { 
  user.items = items;
  fetch(DB+"users/"+user.name+".json", {method:'PUT', body:JSON.stringify(user)}); 
}

function update() { 
  document.getElementById('mon').innerText = user.points.toLocaleString(); 
}

function applyItems() {
  let nickDisplay = user.name;
  if(items.gold_frame) nickDisplay += ' <span class="gold-nick">[–ó–æ–ª–æ—Ç–æ]</span>';
  if(items.crown) nickDisplay += ' üëë';
  if(items.fire) nickDisplay += ' üî•';
  if(items.shield) nickDisplay += ' üõ°Ô∏è';
  if(items.vip) nickDisplay += ' üíé VIP';
  document.getElementById('playerNick').innerHTML = nickDisplay;
}

function show(id) { 
  document.querySelectorAll('.screen').forEach(s=>s.style.display='none'); 
  document.getElementById(id).style.display='block'; 
  if (id === 'menu') loadBotChat();
}

function admT() { 
  if(++cC >= 5) {
    document.getElementById('admin-panel').style.display='block';
    logAdminAccess();
    loadAdminLogs();
    loadUserLog();
    loadPlayers();
  }
}

function closeAdm() { document.getElementById('admin-panel').style.display='none'; cC = 0; }

function toggleP() { 
  pOn = !pOn; 
  document.getElementById('pen-btn').innerText = pOn ? "–®–¢–†–ê–§–ò: –í–ö–õ" : "–®–¢–†–ê–§–ò: –í–ò–ö–õ"; 
  document.getElementById('pen-btn').style.background = pOn ? "var(--red)" : "var(--green)"; 
}

async function delU() {
  let n = document.getElementById('a-n').value.trim();
  if(!n) return alert("–í–≤–µ–¥—ñ—Ç—å –Ω—ñ–∫–Ω–µ–π–º");
  if(confirm(`–í–∏–¥–∞–ª–∏—Ç–∏ ${n}?`)) {
    await fetch(DB+"users/"+n+".json", {method:'DELETE'});
    alert("–í–∏–¥–∞–ª–µ–Ω–æ");
    loadPlayers();
  }
}

async function edO(add) {
  let n = document.getElementById('a-n').value.trim();
  if(!n) return alert("–í–≤–µ–¥—ñ—Ç—å –Ω–∏–∫");
  let amt = prompt(add ? "–°–∫—ñ–ª—å–∫–∏ –¥–æ–¥–∞—Ç–∏?" : "–°–∫—ñ–ª—å–∫–∏ –≤—ñ–¥–Ω—è—Ç–∏?");
  if(isNaN(amt) || amt <= 0) return alert("–ù–µ–≤—ñ—Ä–Ω–∞ —Å—É–º–∞");
  amt = parseInt(amt);
  let r = await fetch(DB+"users/"+n+".json"), d = await r.json();
  if(!d) return alert("–ì—Ä–∞–≤—Ü—è –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ");
  d.points += add ? amt : -amt;
  d.points = Math.max(0, d.points);
  await fetch(DB+"users/"+n+".json", {method:'PUT', body:JSON.stringify(d)});
  alert("–ì—Ä–æ—à—ñ –æ–Ω–æ–≤–ª–µ–Ω–æ");
  loadPlayers();
}

async function loadPlayers() {
  let r = await fetch(DB + "users/.json"), d = await r.json(), list = document.getElementById('player-list');
  list.innerHTML = '';
  if (!d || !Object.keys(d).length) {
    list.innerHTML = '<div style="padding:12px;color:#aaa">–ì—Ä–∞–≤—Ü—ñ–≤ –Ω–µ–º–∞—î</div>';
    return;
  }
  for (let key in d) {
    let u = d[key];
    let displayNick = u.name || key;
    list.innerHTML += `
      <div style="padding:10px; border-bottom:1px solid #ddd; display:flex; justify-content:space-between; align-items:center;">
        <div>
          <strong>${displayNick}</strong><br>
          <small style="color:#555;">
            –Æ–∑: <b>${key}</b><br>
            –ë–∞–ª–∞–Ω—Å: ${u.points || 0} ‚Ç¥ | –†—ñ–≤–µ–Ω—å: ${u.lvl || 1} | –ü–∞—Ä–æ–ª—å: ${u.pass || '‚Äî'}
          </small>
        </div>
        <button class="btn danger" style="width:auto; padding:6px 12px; font-size:13px;" 
                onclick="deleteUser('${key.replace(/'/g, "\\'")}')">–í–ò–î–ê–õ–ò–¢–ò</button>
      </div>
    `;
  }
}

async function deleteUser(username) {
  if(!confirm(`–í–∏–¥–∞–ª–∏—Ç–∏ ${username}?`)) return;
  await fetch(DB+"users/"+username+".json", {method: 'DELETE'});
  alert(`–í–∏–¥–∞–ª–µ–Ω–æ ${username}`);
  loadPlayers();
}

function addQ() {
  let q = document.getElementById('q-in').value.trim(), c = document.getElementById('c-in').value.trim(), w = document.getElementById('w-in').value.trim();
  if(q && c && w){ customQ.push({t:q,cor:c,inc:w}); alert("–î–æ–¥–∞–Ω–æ"); document.getElementById('q-in').value=document.getElementById('c-in').value=document.getElementById('w-in').value=''; }
  else alert("–ó–∞–ø–æ–≤–Ω—ñ—Ç—å —É—Å—ñ –ø–æ–ª—è");
}

function buyItem(item) {
  const prices = {gold_frame:1000, crown:2000, fire:1500, shield:2500, vip:5000};
  if(user.points >= prices[item]){
    user.points -= prices[item];
    items[item] = true;
    applyItems();
    save(); update();
    alert("–ö—É–ø–ª–µ–Ω–æ: " + item);
  } else alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –≥—Ä–æ—à–µ–π!");
}

function showThemes() {
  show('themes');
}

function startTheme(theme) {
  currentTheme = theme;
  usedQuestions.clear();
  renderL();
  show('levels');
}

function renderL() {
  let g = document.getElementById('lgrid'); g.innerHTML = '';
  let maxLvl = 50;
  for(let i=0;i<maxLvl;i++) g.innerHTML += `<div class="lvl ${i<user.lvl?'open':''}" onclick="start(${i})">${i+1}</div>`;
}

function start(i) {
  if(i >= user.lvl) return;
  let pool = currentTheme && themes[currentTheme] ? themes[currentTheme] : [...base, ...customQ];
  if(i >= pool.length) return alert("–ü–∏—Ç–∞–Ω–Ω—è –≤ —Ç–µ–º—ñ –∑–∞–∫—ñ–Ω—á–∏–ª–∏—Å—è!");
  let curr = pool[i];
  document.getElementById('qtext').innerText = `–†—ñ–≤–µ–Ω—å ${i+1}: ${curr.t}`;
  let b = document.getElementById('abox'); b.innerHTML = '';
  [curr.cor, curr.inc].sort(()=>Math.random()-0.5).forEach(o=>{
    let btn = document.createElement('button'); btn.className='btn'; btn.style.background='#444';
    btn.innerText=o; btn.onclick=()=>check(o,curr.cor,i); b.appendChild(btn);
  });
  show('game');
}

function check(p,c,i){
  if(p===c){
    user.points+=1000;
    if(i===user.lvl-1 && user.lvl<50) user.lvl++;
    correctSound.currentTime = 0;
    correctSound.play().catch(()=>{});
    alert("–ü–†–ê–í–ò–õ–¨–ù–û!");

    if([10,20,30,40,50].includes(user.lvl)){
      alert(`–í—ñ—Ç–∞—é! –¢–∏ –ø—Ä–æ–π—à–æ–≤ —Ä—ñ–≤–µ–Ω—å ${user.lvl}\n–†–µ–∑—É–ª—å—Ç–∞—Ç: ${user.points} –æ—á–æ–∫`);
    }
  } else {
    if(pOn) user.points = Math.max(0,user.points-150);
    wrongSound.currentTime = 0;
    wrongSound.play().catch(()=>{});
    alert("‚ùå");
  }
  save(); update(); renderL(); show('levels');
}

async function loadT() {
  show('top'); let r=await fetch(DB+"users/.json"), d=await r.json(), l=document.getElementById('tlist'); l.innerHTML='';
  if(d) {
    let topPlayers = Object.values(d).sort((a,b)=>b.points-a.points).slice(0,1000);
    topPlayers.forEach((u,i)=>l.innerHTML+=`<div style="display:flex;justify-content:space-between;padding:8px"><span>${i+1}. ${u.name}</span><b>${u.points}</b></div>`);
  } else l.innerHTML = '<div style="padding:12px;color:#aaa">–¢–æ–ø –ø–æ—Ä–æ–∂–Ω—ñ–π</div>';
}

async function logAdminAccess() {
  if (user.name !== "–ú–∞—Ä–∫ –î–µ–≤—ñ—Ü—å–∫–∏–π") return;
  const now = new Date().toLocaleString('uk-UA', { timeZone: 'Europe/Kyiv' });
  const entry = { nick: user.name, time: now };
  await fetch(DB + "admin_logs.json", {method: 'POST', body: JSON.stringify(entry)});
}

async function loadAdminLogs() {
  try {
    let r = await fetch(DB + "admin_logs.json");
    let data = await r.json();
    let logDiv = document.getElementById('admin-log');
    logDiv.innerHTML = '';
    if (data) {
      Object.values(data).reverse().forEach(log => {
        logDiv.innerHTML += `<div class="log-entry">${log.time} ‚Äî <b>${log.nick}</b></div>`;
      });
    } else {
      logDiv.innerHTML = '–õ–æ–≥ –ø–æ—Ä–æ–∂–Ω—ñ–π';
    }
  } catch (e) {
    document.getElementById('admin-log').innerHTML = '–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ª–æ–≥—É';
  }
}

async function clearAdminLogs() {
  if (!confirm("–û—á–∏—Å—Ç–∏—Ç–∏ –ª–æ–≥ –∞–¥–º—ñ–Ω–∫–∏?")) return;
  await fetch(DB + "admin_logs.json", {method: 'DELETE'});
  loadAdminLogs();
  alert("–õ–æ–≥ –∞–¥–º—ñ–Ω–∫–∏ –æ—á–∏—â–µ–Ω–æ");
}

async function loadUserLog() {
  try {
    let r = await fetch(DB + "user_logs.json");
    let data = await r.json();
    let logDiv = document.getElementById('user-log');
    logDiv.innerHTML = '';
    if (data) {
      Object.values(data).reverse().slice(0,100).forEach(entry => {
        logDiv.innerHTML += `<div class="log-entry">${entry.time} ‚Äî <b>${entry.game_nick}</b> (TG: @${entry.tg_username})</div>`;
      });
    } else {
      logDiv.innerHTML = '–õ–æ–≥ –ø–æ—Ä–æ–∂–Ω—ñ–π';
    }
  } catch (e) {
    document.getElementById('user-log').innerHTML = '–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è';
  }
}

async function clearUserLog() {
  if (!confirm("–û—á–∏—Å—Ç–∏—Ç–∏ –ª–æ–≥ —É—Å—ñ—Ö –≤—Ö–æ–¥—ñ–≤?")) return;
  await fetch(DB + "user_logs.json", {method: 'DELETE'});
  loadUserLog();
  alert("–õ–æ–≥ –≤—Ö–æ–¥—ñ–≤ –æ—á–∏—â–µ–Ω–æ");
}

async function sendBotMessage() {
  let msg = document.getElementById('bot-message').value.trim();
  if (!msg) return alert("–ù–∞–ø–∏—à–∏ —Ç–µ–∫—Å—Ç!");

  const now = new Date().toLocaleString('uk-UA', {timeZone: 'Europe/Kyiv'});
  const entry = { text: msg, time: now, from: "BOT" };

  await fetch(DB + "bot_chat.json", {
    method: 'POST',
    body: JSON.stringify(entry)
  });

  document.getElementById('bot-message').value = '';
  alert("–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –≤—Å—ñ–º!");
  loadBotChat();
}

async function loadBotChat() {
  let r = await fetch(DB + "bot_chat.json");
  let data = await r.json();
  let box = document.getElementById('bot-chat-box');
  box.innerHTML = '';

  if (data) {
    Object.values(data).sort((a,b) => new Date(a.time) - new Date(b.time)).forEach(msg => {
      let div = document.createElement('div');
      div.className = 'bot-msg';
      div.innerHTML = `<strong>–ë–û–¢:</strong> ${msg.text}<br><small>${msg.time}</small>`;
      box.appendChild(div);
    });
    box.scrollTop = box.scrollHeight;
  }
}

setInterval(() => {
  if (document.getElementById('menu').classList.contains('active')) {
    loadBotChat();
  }
}, 5000);
</script>
</body>
</html>
