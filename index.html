<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>UkrMova Pro</title>
  <style>
    :root {
      --blue: #00a2ff;
      --red: #ff4d4d;
      --green: #2ecc71;
      --gold: #f1c40f;
      --dark: #d32f2f;
    }
    body {
      background: url('https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Ukrainian_ornament.svg/800px-Ukrainian_ornament.svg.png') repeat;
      background-size: 160px;
      color: #000;
      font-family: sans-serif;
      margin: 0;
      text-align: center;
    }
    .screen { display: none; padding: 20px; flex-direction: column; min-height: 100vh; box-sizing: border-box; }
    .active { display: flex; animation: fadeIn 0.3s ease; }
    .card {
      background: rgba(255,255,255,0.92);
      backdrop-filter: blur(10px);
      padding: 20px;
      border-radius: 20px;
      border: 1px solid #444;
      margin: auto;
      width: 100%;
      max-width: 450px;
      box-shadow: 0 0 20px rgba(0,0,0,0.3);
    }
    .btn {
      background: var(--blue);
      color: #fff;
      border: none;
      padding: 14px;
      border-radius: 12px;
      font-weight: 700;
      width: 100%;
      margin: 8px 0;
      cursor: pointer;
      text-transform: uppercase;
      transition: all 0.2s;
    }
    .btn:hover { transform: scale(1.02); box-shadow: 0 0 15px rgba(0,162,255,0.6); }
    .btn.green { background: var(--green); }
    .btn.danger { background: var(--dark); }
    .money { font-size: 32px; font-weight: 900; color: var(--gold); text-shadow: 0 0 10px #f1c40f; }
    .nickname { font-size: 28px; font-weight: bold; margin: 10px 0; cursor: pointer; }
    input {
      background: #f5f5f5;
      border: 1px solid #444;
      padding: 12px;
      border-radius: 8px;
      width: 90%;
      margin: 8px 0;
      font-size: 16px;
    }
    .log-box {
      max-height: 220px;
      overflow-y: auto;
      border: 1px solid #ccc;
      padding: 10px;
      margin: 10px 0;
      background: #f8f8f8;
      border-radius: 8px;
    }
    .log-entry { padding: 4px 0; border-bottom: 1px solid #eee; }
    #admin-panel {
      border: 2px dashed var(--red);
      padding: 15px;
      margin-top: 15px;
      display: none;
      background: rgba(255,255,255,0.92);
      text-align: left;
      border-radius: 15px;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  </style>
</head>
<body>

<div id="auth-screen" class="screen active">
  <div class="card">
    <h2 style="color:var(--gold)">UKRMOVA PRO</h2>
    <input type="text" id="nick" placeholder="Нікнейм" autocomplete="off" />
    <input type="password" id="pass" placeholder="Пароль" autocomplete="off" />
    <button class="btn" onclick="auth()">УВІЙТИ / ЗАРЕЄСТРУВАТИСЯ</button>
    <p id="auth-error" style="color:red; margin-top:10px; min-height:24px;"></p>
  </div>
</div>

<div id="menu" class="screen">
  <div class="card">
    <h3 onclick="admT()" style="cursor:pointer">МЕНЮ</h3>
    <div class="nickname" id="playerNick"></div>
    <div class="money"><span id="mon">0</span> ₴</div>
    <button class="btn" onclick="show('themes')">ГРАТИ</button>
    <button class="btn" style="background:#333" onclick="loadTop()">ТОП</button>
    <button class="btn green" onclick="show('shop')">МАГАЗИН</button>

    <div id="admin-panel">
      <b style="color:var(--red);cursor:pointer" onclick="closeAdm()">❌ ЗАКРИТИ</b><br><br>
      <p><b>Управління гравцями</b></p>
      <input type="text" id="a-n" placeholder="Нік гравця" />
      <button class="btn" style="background:var(--green);color:#000" onclick="editPoints(true)">+ ГРОШІ</button>
      <button class="btn" style="background:var(--red)" onclick="editPoints(false)">- ГРОШІ</button>
      <button class="btn danger" onclick="deleteUser()">ВИДАЛИТИ</button>
      <br><br>
      <button class="btn" style="background:var(--blue);width:100%" onclick="loadPlayers()">ПОКАЗАТИ ВСІХ ГРАВЦІВ</button>
      <div id="player-list" style="max-height:220px;overflow-y:auto;margin:15px 0;background:#fff;padding:10px;border:1px solid #ccc;border-radius:8px"></div>

      <h4 style="color:var(--blue); margin-top:20px;">Лог входів в адмінку</h4>
      <div id="admin-log" class="log-box">Завантаження...</div>
      <button class="btn" style="background:#ff9800; margin-top:8px;" onclick="loadAdminLogs()">Оновити</button>
      <button class="btn danger" style="margin-top:8px;" onclick="clearAdminLogs()">Очистити</button>
    </div>
  </div>
</div>

<div id="shop" class="screen">
  <div class="card">
    <h2>Магазин</h2>
    <div class="shop-grid">
      <div class="shop-item" onclick="buyItem('gold_frame')">Золота рамка — 1000 ₴</div>
      <div class="shop-item" onclick="buyItem('crown')">Корона — 2000 ₴</div>
      <div class="shop-item" onclick="buyItem('fire')">Полум'я — 1500 ₴</div>
      <div class="shop-item" onclick="buyItem('shield')">Щит — 2500 ₴</div>
      <div class="shop-item" onclick="buyItem('vip')">ВІП — 5000 ₴</div>
    </div>
    <button class="btn" onclick="show('menu')">НАЗАД</button>
  </div>
</div>

<div id="themes" class="screen">
  <div class="card">
    <h2>Обери тему</h2>
    <button class="btn theme-btn" onclick="startTheme('vydminy')">Відміни іменників</button>
    <button class="btn theme-btn" onclick="startTheme('prykmetnyky')">Прикметники</button>
    <button class="btn theme-btn" onclick="startTheme('grupy_prykmetnykiv')">Групи прикметників за значенням</button>
    <button class="btn theme-btn" onclick="startTheme('orudnyi_1vidmina')">Орудний відмінок 1 відміни</button>
    <button class="btn red" onclick="show('menu')">НАЗАД</button>
  </div>
</div>

<div id="game" class="screen">
  <div class="card">
    <h3 id="qtext"></h3>
    <div id="abox"></div>
    <button class="btn red" style="margin-top:20px;" onclick="show('themes')">НАЗАД</button>
  </div>
</div>

<div id="top" class="screen">
  <div class="card">
    <h3>ТОП 1000</h3>
    <div id="tlist">Завантаження...</div>
    <button class="btn" onclick="show('menu')">НАЗАД</button>
  </div>
</div>

<script>
const DB = "https://ukrmova-game-default-rtdb.europe-west1.firebasedatabase.app/";
let user = null;
let currentTheme = '';
let currentIndex = 0;
let correctCount = 0;
let wrongCount = 0;
let adminClickCount = 0;

const correctSound = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3");
const wrongSound   = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3");

const themes = {
  vydminy: [
    {q:"До якої відміни належить слово «книга»?", a:"перша відміна", w:["друга відміна"]},
    {q:"До якої відміни належить слово «стіл»?", a:"друга відміна", w:["перша відміна"]},
    {q:"До якої відміни належить слово «мати»?", a:"третя відміна", w:["перша відміна"]},
    {q:"До якої відміни належить слово «ім'я»?", a:"четверта відміна", w:["третя відміна"]},
    {q:"До якої відміни належать іменники середнього роду на -о/-е?", a:"друга відміна", w:["перша відміна"]},
    {q:"До якої відміни належить слово «любов»?", a:"третя відміна", w:["друга відміна"]},
    {q:"До якої відміни належить слово «сіль»?", a:"третя відміна", w:["четверта відміна"]},
    {q:"До якої відміни належить слово «серце»?", a:"друга відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «земля»?", a:"перша відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «день»?", a:"друга відміна", w:["перша відміна"]},
    {q:"До якої відміни належать іменники жіночого роду на приголосний?", a:"третя відміна", w:["перша відміна"]},
    {q:"До якої відміни належить слово «дитина»?", a:"перша відміна", w:["друга відміна"]},
    {q:"До якої відміни належить слово «вікно»?", a:"друга відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «тінь»?", a:"третя відміна", w:["перша відміна"]},
    {q:"До якої відміни належить слово «місто»?", a:"друга відміна", w:["перша відміна"]},
    {q:"До якої відміни належить слово «кров»?", a:"третя відміна", w:["друга відміна"]},
    {q:"До якої відміни належить слово «дерево»?", a:"друга відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «мама»?", a:"перша відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «око»?", a:"друга відміна", w:["перша відміна"]},
    {q:"До якої відміни належить слово «рука»?", a:"перша відміна", w:["друга відміна"]},
    {q:"До якої відміни належить слово «пісня»?", a:"перша відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «море»?", a:"друга відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «гість»?", a:"друга відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «голова»?", a:"перша відміна", w:["друга відміна"]},
    {q:"До якої відміни належить слово «яблуко»?", a:"друга відміна", w:["перша відміна"]},
    {q:"До якої відміни належить слово «сестра»?", a:"перша відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «хліб»?", a:"друга відміна", w:["перша відміна"]},
    {q:"До якої відміни належить слово «молодість»?", a:"третя відміна", w:["перша відміна"]},
    {q:"До якої відміни належить слово «сонце»?", a:"друга відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «вулиця»?", a:"перша відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «вітер»?", a:"друга відміна", w:["перша відміна"]},
    {q:"До якої відміни належить слово «радість»?", a:"третя відміна", w:["перша відміна"]},
    {q:"До якої відміни належить слово «річка»?", a:"перша відміна", w:["друга відміна"]},
    {q:"До якої відміни належить слово «ліс»?", a:"друга відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «двері»?", a:"множинний", w:["третя відміна"]},
    {q:"До якої відміни належить слово «гора»?", a:"перша відміна", w:["друга відміна"]},
    {q:"До якої відміни належить слово «поле»?", a:"друга відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «знання»?", a:"друга відміна", w:["перша відміна"]},
    {q:"До якої відміни належить слово «дружба»?", a:"перша відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «будинок»?", a:"друга відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «мова»?", a:"перша відміна", w:["друга відміна"]},
    {q:"До якої відміни належить слово «життя»?", a:"друга відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «людина»?", a:"перша відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «час»?", a:"друга відміна", w:["перша відміна"]},
    {q:"До якої відміни належить слово «надія»?", a:"перша відміна", w:["друга відміна"]},
    {q:"До якої відміни належить слово «вода»?", a:"перша відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «сон»?", a:"друга відміна", w:["перша відміна"]},
    {q:"До якої відміни належить слово «ніч»?", a:"третя відміна", w:["друга відміна"]},
    {q:"До якої відміни належить слово «руки»?", a:"перша відміна", w:["третя відміна"]},
    {q:"До якої відміни належить слово «очі»?", a:"друга відміна", w:["третя відміна"]}
  ],
  prykmetnyky: [
    {q:"Який рід прикметника «гарна дівчина»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «велике поле»?", a:"середній рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «сильний чоловік»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «красива квітка»?", a:"жіночий рід", w:["середній рід"]},
    {q:"Який рід прикметника «нове авто»?", a:"середній рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «довга дорога»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «високий будинок»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «маленька дитина»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «старий дідусь»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «молодий хлопець»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «цікава книга»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «важке завдання»?", a:"середній рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «солодкий торт»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «гаряча кава»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «холодний лід»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «смачна піца»?", a:"жіночий рід", w:["середній рід"]},
    {q:"Який рід прикметника «сильна жінка»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «швидкий автомобіль»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «повільна черепаха»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «розумний хлопець»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «розумна дівчина»?", a:"жіночий рід", w:["середній рід"]},
    {q:"Який рід прикметника «веселий настрій»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «сумна пісня»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «добрий чоловік»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «злий собака»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «тепла погода»?", a:"жіночий рід", w:["середній рід"]},
    {q:"Який рід прикметника «холодне молоко»?", a:"середній рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «яскравий колір»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «темна ніч»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «світла кімната»?", a:"жіночий рід", w:["середній рід"]},
    {q:"Який рід прикметника «важлива справа»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «цікавий фільм»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «нудний урок»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «смішний жарт»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «серйозний чоловік»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «весела музика»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «сумна історія»?", a:"жіночий рід", w:["середній рід"]},
    {q:"Який рід прикметника «добре серце»?", a:"середній рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «зле око»?", a:"середній рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «новий рік»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «старе дерево»?", a:"середній рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «молоде покоління»?", a:"середній рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «висока гора»?", a:"жіночий рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «низький стіл»?", a:"чоловічий рід", w:["середній рід"]},
    {q:"Який рід прикметника «широкий шлях»?", a:"чоловічий рід", w:["жіночий рід"]},
    {q:"Який рід прикметника «вузька вулиця»?", a:"жіночий рід", w:["середній рід"]},
    {q:"Який рід прикметника «довге волосся»?", a:"середній рід", w:["чоловічий рід"]},
    {q:"Який рід прикметника «короткий шлях»?", a:"чоловічий рід", w:["жіночий рід"]}
  ],
  grupy_prykmetnykiv: [
    {q:"До якої групи за значенням належить прикметник «гарна» (гарна дівчина)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «дерев’яний» (дерев’яний стіл)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «мамина» (мамина сумка)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «залізний» (залізний характер)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «вовча» (вовча зграя)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «смачний» (смачний пиріг)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «батьків» (батьків дім)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «золотий» (золотий ланцюжок)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «розумний» (розумний хлопчик)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «сестрин» (сестрин зошит)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «зимовий» (зимовий вечір)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «гарячий» (гарячий чай)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «лисяча» (лисяча нора)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «високий» (високий чоловік)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «книжковий» (книжкова шафа)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «тітчин» (тітчин подарунок)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «солодкий» (солодкий мед)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «шкільний» (шкільний двір)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «дідусів» (дідусів годинник)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «красивий» (красивий краєвид)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «весняний» (весняний дощ)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «холодний» (холодний вітер)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «бабусин» (бабусин пиріг)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «металевий» (металевий міст)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «сильний» (сильний дощ)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «Ольжин» (Ольжин зошит)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «паперовий» (паперовий літак)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «веселий» (веселий настрій)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «ведмежа» (ведмежа берлога)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «цегляний» (цегляний будинок)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «теплий» (теплий вечір)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «Іванів» (Іванів велосипед)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «скляний» (скляний посуд)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «розумний» (розумний вчинок)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «собача» (собача будка)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «широкий» (широкий шлях)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «дитячий» (дитячий майданчик)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «чистий» (чисте небо)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «Петрів» (Петрів собака)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «пластиковий» (пластиковий стакан)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «сумний» (сумний погляд)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «вороняче» (вороняче гніздо)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «осінній» (осінній ліс)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «легкий» (легкий вітерець)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «мамине» (мамине плаття)?", a:"присвійний", w:["якісний","відносний"]},
    {q:"До якої групи належить «мідний» (мідний таз)?", a:"відносний", w:["якісний","присвійний"]},
    {q:"До якої групи належить «гордий» (гордий вигляд)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «золотий» (золота осінь – переносне значення)?", a:"якісний", w:["відносний","присвійний"]},
    {q:"До якої групи належить «братів» (братів телефон)?", a:"присвійний", w:["якісний","відносний"]}
  ],
  orudnyi_1vidmina: [
    {q:"Орудний відмінок слова «книжка»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «душа»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «свіча»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «миша»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «площа»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «тиша»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «зброя»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «ніч»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «армія»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «сім'я»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «надія»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «ідея»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «лінія»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «фотографія»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «історія»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «традиція»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «революція»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «станція»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «вода»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «рука»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «річка»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «дорога»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «гора»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «дитина»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «сестра»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «школа»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «вулиця»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «пісня»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «голова»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «дівчина»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «квітка»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «зірка»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «машина»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «хвилина»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «акція»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «функція»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «секція»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «дискусія»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «екскурсія»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «конференція»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «організація»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «асоціація»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «нація»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «стаття»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «партія»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «компанія»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «фабрика»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «лабораторія»?", a:"-єю", w:["-ою","-ею"]},
    {q:"Орудний відмінок слова «галерея»?", a:"-єю", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «бібліотека»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «аптека»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «поліклініка»?", a:"-ою", w:["-ею","-єю"]},
    {q:"Орудний відмінок слова «кухня»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «спальня»?", a:"-ею", w:["-ою","-єю"]},
    {q:"Орудний відмінок слова «вітальня»?", a:"-ею", w:["-ою","-єю"]}
  ]
};

async function auth() {
  const nick = document.getElementById('nick').value.trim();
  const pass = document.getElementById('pass').value.trim();
  const errorEl = document.getElementById('auth-error');

  if (!nick || !pass) {
    errorEl.textContent = "Введіть нікнейм і пароль";
    return;
  }

  errorEl.textContent = "Завантаження...";

  try {
    let res = await fetch(`${DB}users/${nick}.json`);
    let data = await res.json();

    if (data) {
      if (data.pass === pass) {
        user = data;
      } else {
        errorEl.textContent = "Неправильний пароль";
        return;
      }
    } else {
      user = { name: nick, pass: pass, points: 0 };
      await fetch(`${DB}users/${nick}.json`, {
        method: 'PUT',
        body: JSON.stringify(user)
      });
    }

    localStorage.setItem('un', nick);
    localStorage.setItem('up', pass);

    document.getElementById('playerNick').textContent = user.name;
    document.getElementById('mon').textContent = user.points.toLocaleString();

    show('menu');
    errorEl.textContent = "";
  } catch (err) {
    errorEl.textContent = "Помилка підключення до бази";
    console.error(err);
  }
}

// Автологін
window.addEventListener('load', () => {
  const savedNick = localStorage.getItem('un');
  const savedPass = localStorage.getItem('up');
  if (savedNick && savedPass) {
    document.getElementById('nick').value = savedNick;
    document.getElementById('pass').value = savedPass;
    auth();
  }
});

function show(id) {
  document.querySelectorAll('.screen').forEach(el => el.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function admT() {
  adminClickCount++;
  if (adminClickCount >= 5) {
    document.getElementById('admin-panel').style.display = 'block';
    logAdminAccess();
    loadAdminLogs();
  }
}

async function logAdminAccess() {
  if (!user) return;
  const now = new Date().toLocaleString('uk-UA', { timeZone: 'Europe/Kyiv' });
  const entry = { nick: user.name, time: now };
  await fetch(DB + "admin_logs/.json", {
    method: 'POST',
    body: JSON.stringify(entry)
  });
}

async function loadAdminLogs() {
  try {
    let res = await fetch(DB + "admin_logs/.json");
    let data = await res.json();
    let logDiv = document.getElementById('admin-log');
    logDiv.innerHTML = '';
    if (data) {
      Object.values(data).reverse().forEach(log => {
        logDiv.innerHTML += `<div class="log-entry">${log.time} — <b>${log.nick}</b></div>`;
      });
    } else {
      logDiv.innerHTML = 'Лог порожній';
    }
  } catch (e) {
    document.getElementById('admin-log').innerHTML = 'Помилка завантаження';
  }
}

async function clearAdminLogs() {
  if (!confirm("Очистити лог входів в адмінку?")) return;
  await fetch(DB + "admin_logs/.json", { method: 'DELETE' });
  loadAdminLogs();
  alert("Лог адмінки очищено");
}

function closeAdm() {
  document.getElementById('admin-panel').style.display = 'none';
  adminClickCount = 0;
}

// Гра
function startTheme(theme) {
  currentTheme = theme;
  currentIndex = 0;
  correctCount = 0;
  wrongCount = 0;
  show('game');
  loadQuestion();
}

function loadQuestion() {
  const pool = themes[currentTheme];
  if (currentIndex >= pool.length) {
    document.getElementById('qtext').textContent = "Тема завершена!";
    document.getElementById('abox').innerHTML = `
      <div style="font-size:22px; margin:20px 0; line-height:1.6;">
        <strong>Гравець:</strong> ${user ? user.name : '—'}<br>
        <strong style="color:var(--green)">Правильних:</strong> ${correctCount}<br>
        <strong style="color:var(--red)">Неправильних:</strong> ${wrongCount}<br><br>
        <strong>Поточний баланс:</strong> ${user ? user.points.toLocaleString() : 0} ₴
      </div>
      <button class="btn" onclick="show('themes')">Обрати іншу тему</button>
    `;
    return;
  }

  const q = pool[currentIndex];
  document.getElementById('qtext').textContent = `Питання ${currentIndex + 1}/${pool.length}: ${q.q}`;

  const abox = document.getElementById('abox');
  abox.innerHTML = '';

  let answers = [q.a, ...q.w];
  answers.sort(() => Math.random() - 0.5);

  answers.forEach(ans => {
    const btn = document.createElement('button');
    btn.className = 'btn';
    btn.textContent = ans;
    btn.onclick = () => checkAnswer(ans, q.a);
    abox.appendChild(btn);
  });
}

function checkAnswer(selected, correct) {
  if (selected === correct) {
    correctCount++;
    if (user) user.points += 100;
    correctSound.currentTime = 0;
    correctSound.play().catch(() => {});
  } else {
    wrongCount++;
    if (user) user.points = Math.max(0, user.points - 30);
    wrongSound.currentTime = 0;
    wrongSound.play().catch(() => {});
  }

  if (user) document.getElementById('mon').textContent = user.points.toLocaleString();
  if (user) saveUser();

  currentIndex++;
  loadQuestion();
}

function saveUser() {
  if (!user) return;
  fetch(`${DB}users/${user.name}.json`, {
    method: 'PUT',
    body: JSON.stringify(user)
  }).catch(err => console.error(err));
}

// ТОП
async function loadTop() {
  show('top');
  try {
    let res = await fetch(`${DB}users/.json`);
    let data = await res.json();
    let list = document.getElementById('tlist');
    list.innerHTML = '';
    if (data) {
      let players = Object.values(data)
        .filter(p => p && p.points !== undefined)
        .sort((a, b) => b.points - a.points)
        .slice(0, 1000);
      players.forEach((p, i) => {
        list.innerHTML += `<div style="padding:8px; border-bottom:1px solid #eee;">
          ${i+1}. <b>${p.name}</b> — ${p.points.toLocaleString()} ₴
        </div>`;
      });
    } else {
      list.innerHTML = '<p style="color:#aaa">Ще немає гравців</p>';
    }
  } catch (e) {
    document.getElementById('tlist').innerHTML = 'Помилка завантаження';
  }
}

// Магазин (простий приклад)
function buyItem(item) {
  const prices = {gold_frame:1000, crown:2000, fire:1500, shield:2500, vip:5000};
  if (user.points >= prices[item]) {
    user.points -= prices[item];
    alert(`Куплено: ${item}`);
    saveUser();
    document.getElementById('mon').textContent = user.points.toLocaleString();
  } else {
    alert("Недостатньо коштів!");
  }
}
</script>
</body>
</html>
