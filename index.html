<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>UkrMova Pro</title>
<style>
:root{--blue:#00a2ff;--red:#ff4d4d;--green:#2ecc71;--gold:#f1c40f;--dark:#d32f2f}
body{background:url('https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Ukrainian_ornament.svg/800px-Ukrainian_ornament.svg.png') repeat;background-size:160px;color:#000;font-family:sans-serif;margin:0;text-align:center}
.screen{display:none;padding:20px;flex-direction:column;min-height:100vh;box-sizing:border-box}
.active{display:flex;animation:fadeIn .3s ease}
.card{background:rgba(255,255,255,0.92);backdrop-filter:blur(10px);padding:20px;border-radius:20px;border:1px solid #444;margin:auto;width:100%;max-width:450px;box-shadow:0 0 20px rgba(0,0,0,0.3)}
.btn{background:var(--blue);color:#fff;border:none;padding:14px;border-radius:12px;font-weight:700;width:100%;margin:6px 0;cursor:pointer;text-transform:uppercase;transition:all .2s}
.btn:hover{transform:scale(1.02);box-shadow:0 0 15px rgba(0,162,255,.6)}
.btn.green{background:var(--green)}
.btn.danger{background:var(--dark)}
.money{font-size:32px;font-weight:900;color:var(--gold);text-shadow:0 0 10px #f1c40f}
.nickname{font-size:28px;font-weight:bold;margin:10px 0;cursor:pointer}
.gold-nick{color:var(--gold);text-shadow:0 0 10px var(--gold)}
.lvl-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;max-height:40vh;overflow-y:auto;padding:10px}
.lvl{background:rgba(51,51,51,0.7);padding:12px 0;border-radius:10px;opacity:0.6;transition:all .3s;border:1px solid #ccc}
.lvl.open{opacity:1;background:var(--blue);border:2px solid white;box-shadow:0 0 15px var(--blue);color:white}
#admin-panel{border:2px dashed var(--red);padding:15px;margin-top:15px;display:none;background:rgba(255,255,255,0.92);text-align:left;border-radius:15px}
input{background:#f5f5f5;border:1px solid #444;padding:10px;border-radius:8px;color:#000;width:90%;margin-bottom:8px}
.shop-item{background:#eee;padding:12px;margin:8px 0;border-radius:10px;cursor:pointer}
.shop-item.bought{background:#c8e6c9}
.shop-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
.theme-btn{background:#9c27b0;color:white}
.log-box{max-height:220px;overflow-y:auto;border:1px solid #ccc;padding:10px;margin:10px 0;background:#f8f8f8;border-radius:8px}
.log-entry{padding:4px 0;border-bottom:1px solid #eee}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
</style>
</head>
<body>

<div id="auth-screen" class="screen active">
  <div class="card">
    <h2 style="color:var(--gold)">UKRMOVA PRO</h2>
    <input type="text" id="nick" placeholder="Нікнейм">
    <input type="password" id="pass" placeholder="Пароль">
    <button class="btn" onclick="auth()">УВІЙТИ</button>
  </div>
</div>

<div id="menu" class="screen">
  <div class="card">
    <h3 onclick="admT()" style="cursor:pointer">МЕНЮ</h3>
    <div class="nickname" id="playerNick"></div>
    <div class="money"><span id="mon">0</span> ₴</div>

    <button class="btn" onclick="showThemes()">ГРАТИ</button>
    <button class="btn" style="background:#333" onclick="loadT()">ТОП</button>
    <button class="btn green" onclick="show('shop')">МАГАЗИН</button>

    <div id="admin-panel">
      <b style="color:var(--red);cursor:pointer" onclick="closeAdm()">❌ ЗАКРИТИ</b><br><br>
      <button class="btn" id="pen-btn" style="background:var(--red)" onclick="toggleP()">ШТРАФИ: ВКЛ</button>

      <p><b>Управління гравцями</b></p>
      <input type="text" id="a-n" placeholder="Нік гравця">
      <button class="btn" style="background:var(--green);color:#000" onclick="edO(true)">+ ГРОШІ</button>
      <button class="btn" style="background:var(--red)" onclick="edO(false)">- ГРОШІ</button>
      <button class="btn danger" onclick="delU()">ВИДАЛИТИ ЗА НІКОМ</button>

      <br><br>
      <button class="btn" style="background:var(--blue);width:100%" onclick="loadPlayers()">ПОКАЗАТИ ВСІХ ГРАВЦІВ</button>

      <div id="player-list" style="max-height:250px;overflow-y:auto;margin:15px 0;background:#fff;padding:10px;border:1px solid #ccc;border-radius:8px"></div>

      <br><br>
      <h4 style="color:var(--blue)">Лог входів в адмінку</h4>
      <div id="admin-log" class="log-box">Завантаження...</div>
      <button class="btn" style="background:#ff9800" onclick="clearAdminLogs()">Очистити лог адмінки</button>

      <br><br>
      <h4 style="color:var(--blue)">Лог усіх входів у гру</h4>
      <div id="user-log" class="log-box">Завантаження...</div>
      <button class="btn" style="background:#ff9800;margin-top:8px" onclick="loadUserLog()">Оновити</button>
      <button class="btn danger" style="margin-top:8px" onclick="clearUserLog()">Очистити</button>
    </div>
  </div>
</div>

<div id="shop" class="screen">
  <div class="card">
    <h2>Магазин</h2>
    <div class="shop-grid">
      <div class="shop-item" id="gold_frame" onclick="buyItem('gold_frame')">Золота рамка — 1000 ₴</div>
      <div class="shop-item" id="crown" onclick="buyItem('crown')">Корона — 2000 ₴</div>
      <div class="shop-item" id="fire" onclick="buyItem('fire')">Полум'я — 1500 ₴</div>
      <div class="shop-item" id="shield" onclick="buyItem('shield')">Щит — 2500 ₴</div>
      <div class="shop-item" id="vip" onclick="buyItem('vip')">ВІП — 5000 ₴</div>
    </div>
    <button class="btn" onclick="show('menu')">НАЗАД</button>
  </div>
</div>

<div id="themes" class="screen">
  <div class="card">
    <h2>Обери тему</h2>
    <button class="btn theme-btn" onclick="startTheme('vydminy')">Відміни іменників</button>
    <button class="btn theme-btn" onclick="startTheme('chasyslova')">Часи дієслів</button>
    <button class="btn theme-btn" onclick="startTheme('prykmetnyky')">Прикметники</button>
    <button class="btn theme-btn" onclick="startTheme('pryslinniky')">Прислівники</button>
    <button class="btn theme-btn" onclick="startTheme('synonimy')">Синоніми / Антоніми</button>
    <button class="btn red" onclick="show('menu')">НАЗАД</button>
  </div>
</div>

<div id="levels" class="screen"><div class="card"><h3>РІВНІ</h3><div class="lvl-grid" id="lgrid"></div><button class="btn" onclick="show('menu')">НАЗАД</button></div></div>
<div id="game" class="screen"><div class="card"><h3 id="qtext"></h3><div id="abox"></div></div></div>
<div id="top" class="screen"><div class="card"><h3>ТОП 1000</h3><div id="tlist"></div><button class="btn" onclick="show('menu')">НАЗАД</button></div></div>

<script>
const DB = "https://ukrmova-game-default-rtdb.europe-west1.firebasedatabase.app/";
let user = null, cC = 0, pOn = true, customQ = [], usedQuestions = new Set();
let items = { gold_frame: false, crown: false, fire: false, shield: false, vip: false };
let currentTheme = '';

const correctSound = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3");
const wrongSound = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3");

document.addEventListener('click', () => {
  correctSound.play().catch(()=>{});
  wrongSound.play().catch(()=>{});
}, {once: true});

window.onload = () => {
  if(localStorage.getItem('un')) document.getElementById('nick').value = localStorage.getItem('un');
  if(localStorage.getItem('up')) document.getElementById('pass').value = localStorage.getItem('up');
};

const base = [
  {t:"До якої відміни належить слово «книга»?",cor:"перша відміна",inc:"друга відміна"},
  {t:"До якої відміни належить слово «стіл»?",cor:"друга відміна",inc:"перша відміна"},
  {t:"До якої відміни належить слово «ніч»?",cor:"третя відміна",inc:"четверта відміна"},
  {t:"До якої відміни належить слово «поле»?",cor:"друга відміна",inc:"третя відміна"},
  {t:"До якої відміни належать іменники жіночого роду на -а/-я?",cor:"перша відміна",inc:"друга відміна"}
];

const themes = {
  vydminy: [
    {t:"До якої відміни належить слово «книга»?",cor:"перша відміна",inc:"друга відміна"},
    {t:"До якої відміни належить слово «стіл»?",cor:"друга відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «мати»?",cor:"третя відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «ім'я»?",cor:"четверта відміна",inc:"третя відміна"},
    {t:"До якої відміни належать іменники середнього роду на -о/-е?",cor:"друга відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «любов»?",cor:"третя відміна",inc:"друга відміна"},
    {t:"До якої відміни належить слово «сіль»?",cor:"третя відміна",inc:"четверта відміна"},
    {t:"До якої відміни належить слово «серце»?",cor:"друга відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «земля»?",cor:"перша відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «день»?",cor:"друга відміна",inc:"перша відміна"},
    {t:"До якої відміни належать іменники жіночого роду на приголосний?",cor:"третя відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «дитина»?",cor:"перша відміна",inc:"друга відміна"},
    {t:"До якої відміни належить слово «вікно»?",cor:"друга відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «тінь»?",cor:"третя відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «місто»?",cor:"друга відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «кров»?",cor:"третя відміна",inc:"друга відміна"},
    {t:"До якої відміни належить слово «дерево»?",cor:"друга відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «мама»?",cor:"перша відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «око»?",cor:"друга відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «рука»?",cor:"перша відміна",inc:"друга відміна"},
    {t:"До якої відміни належить слово «пісня»?",cor:"перша відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «море»?",cor:"друга відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «гість»?",cor:"друга відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «голова»?",cor:"перша відміна",inc:"друга відміна"},
    {t:"До якої відміни належить слово «яблуко»?",cor:"друга відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «сестра»?",cor:"перша відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «хліб»?",cor:"друга відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «молодість»?",cor:"третя відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «сонце»?",cor:"друга відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «вулиця»?",cor:"перша відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «вітер»?",cor:"друга відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «радість»?",cor:"третя відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «річка»?",cor:"перша відміна",inc:"друга відміна"},
    {t:"До якої відміни належить слово «ліс»?",cor:"друга відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «двері»?",cor:"третя відміна",inc:"друга відміна"},
    {t:"До якої відміни належить слово «гора»?",cor:"перша відміна",inc:"друга відміна"},
    {t:"До якої відміни належить слово «поле» у множині?",cor:"друга відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «знання»?",cor:"друга відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «дружба»?",cor:"третя відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «будинок»?",cor:"друга відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «мова»?",cor:"перша відміна",inc:"друга відміна"},
    {t:"До якої відміни належить слово «життя»?",cor:"друга відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «людина»?",cor:"перша відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «час»?",cor:"друга відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «надія»?",cor:"третя відміна",inc:"друга відміна"},
    {t:"До якої відміни належить слово «вода»?",cor:"перша відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «сон»?",cor:"друга відміна",inc:"перша відміна"},
    {t:"До якої відміни належить слово «ніч» у множині?",cor:"третя відміна",inc:"друга відміна"},
    {t:"До якої відміни належить слово «руки»?",cor:"перша відміна",inc:"третя відміна"},
    {t:"До якої відміни належить слово «очі»?",cor:"третя відміна",inc:"друга відміна"}
  ],
  chasyslova: [
    {t:"Який час дієслова «читати» у реченні «Я читав книгу»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «писати» у реченні «Він пише листа»?",cor:"теперішній час",inc:"майбутній час"},
    {t:"Який час дієслова «йти» у реченні «Я йду додому»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «будувати» у реченні «Ми побудуємо будинок»?",cor:"майбутній час",inc:"минулий час"},
    {t:"Який час дієслова «співати» у реченні «Вона співала пісню»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «говорити» у реченні «Вони говорять швидко»?",cor:"теперішній час",inc:"майбутній час"},
    {t:"Який час дієслова «їсти» у реченні «Я їв борщ»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «дивитися» у реченні «Ми будемо дивитися фільм»?",cor:"майбутній час",inc:"минулий час"},
    {t:"Який час дієслова «малювати» у реченні «Дитина малює»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «грати» у реченні «Він грав у футбол»?",cor:"минулий час",inc:"майбутній час"},
    {t:"Який час дієслова «бігти» у реченні «Вона бігла швидко»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «спати» у реченні «Я сплю вночі»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «танцювати» у реченні «Вони будуть танцювати»?",cor:"майбутній час",inc:"минулий час"},
    {t:"Який час дієслова «пити» у реченні «Він пив каву»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «читати» у реченні «Ми читаємо книгу»?",cor:"теперішній час",inc:"майбутній час"},
    {t:"Який час дієслова «писати» у реченні «Я напишу листа»?",cor:"майбутній час",inc:"минулий час"},
    {t:"Який час дієслова «бачити» у реченні «Вона бачила сон»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «слухати» у реченні «Ми слухаємо музику»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «робити» у реченні «Він зробив уроки»?",cor:"минулий час",inc:"майбутній час"},
    {t:"Який час дієслова «любити» у реченні «Я люблю Україну»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «знати» у реченні «Вона знала відповідь»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «хотіти» у реченні «Він хоче їсти»?",cor:"теперішній час",inc:"майбутній час"},
    {t:"Який час дієслова «могти» у реченні «Ми могли допомогти»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «мати» у реченні «Вона має собаку»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «жити» у реченні «Я живу в Сумах»?",cor:"теперішній час",inc:"майбутній час"},
    {t:"Який час дієслова «працювати» у реченні «Він працював вчора»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «навчатися» у реченні «Вона вчиться в школі»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «грати» у реченні «Ми будемо грати»?",cor:"майбутній час",inc:"минулий час"},
    {t:"Який час дієслова «співати» у реченні «Вони співали пісню»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «танцювати» у реченні «Діти танцюють»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «малювати» у реченні «Я намалюю картину»?",cor:"майбутній час",inc:"минулий час"},
    {t:"Який час дієслова «читати» у реченні «Він читав книгу»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «писати» у реченні «Ми пишемо диктант»?",cor:"теперішній час",inc:"майбутній час"},
    {t:"Який час дієслова «дивитися» у реченні «Вона дивилася фільм»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «слухати» у реченні «Він слухає музику»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «їсти» у реченні «Ми їмо борщ»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «пити» у реченні «Вона пила чай»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «бігти» у реченні «Він біг швидко»?",cor:"минулий час",inc:"майбутній час"},
    {t:"Який час дієслова «спати» у реченні «Я сплю вночі»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «ходити» у реченні «Ми ходили в парк»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «жити» у реченні «Вона жила в Києві»?",cor:"минулий час",inc:"майбутній час"},
    {t:"Який час дієслова «працювати» у реченні «Він працює в офісі»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «навчатися» у реченні «Діти навчаються»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «любити» у реченні «Я люблю маму»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «знати» у реченні «Він знав відповідь»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «хотіти» у реченні «Вона хоче піти»?",cor:"теперішній час",inc:"майбутній час"},
    {t:"Який час дієслова «могти» у реченні «Ми могли допомогти»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «мати» у реченні «Він має машину»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «бачити» у реченні «Я бачу сонце»?",cor:"теперішній час",inc:"минулий час"},
    {t:"Який час дієслова «слухати» у реченні «Вони слухали музику»?",cor:"минулий час",inc:"теперішній час"},
    {t:"Який час дієслова «грати» у реченні «Діти грають у футбол»?",cor:"теперішній час",inc:"минулий час"}
  ],
  prykmetnyky: [
    {t:"Який рід прикметника «гарний» у реченні «гарна дівчина»?",cor:"жіночий рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «великий» у реченні «велике поле»?",cor:"середній рід",inc:"жіночий рід"},
    {t:"Який рід прикметника «сильний» у реченні «сильний чоловік»?",cor:"чоловічий рід",inc:"жіночий рід"},
    {t:"Який рід прикметника «красива» у реченні «красива квітка»?",cor:"жіночий рід",inc:"середній рід"},
    {t:"Який рід прикметника «нове» у реченні «нове авто»?",cor:"середній рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «довгий» у реченні «довга дорога»?",cor:"жіночий рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «високий» у реченні «високий будинок»?",cor:"чоловічий рід",inc:"середній рід"},
    {t:"Який рід прикметника «маленька» у реченні «маленька дитина»?",cor:"жіночий рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «старий» у реченні «старий дідусь»?",cor:"чоловічий рід",inc:"жіночий рід"},
    {t:"Який рід прикметника «молодий» у реченні «молодий хлопець»?",cor:"чоловічий рід",inc:"середній рід"},
    {t:"Який рід прикметника «цікава» у реченні «цікава книга»?",cor:"жіночий рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «важке» у реченні «важке завдання»?",cor:"середній рід",inc:"жіночий рід"},
    {t:"Який рід прикметника «солодкий» у реченні «солодкий торт»?",cor:"чоловічий рід",inc:"середній рід"},
    {t:"Який рід прикметника «гаряча» у реченні «гаряча кава»?",cor:"жіночий рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «холодний» у реченні «холодний лід»?",cor:"чоловічий рід",inc:"жіночий рід"},
    {t:"Який рід прикметника «смачна» у реченні «смачна піца»?",cor:"жіночий рід",inc:"середній рід"},
    {t:"Який рід прикметника «сильна» у реченні «сильна жінка»?",cor:"жіночий рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «швидкий» у реченні «швидкий автомобіль»?",cor:"чоловічий рід",inc:"середній рід"},
    {t:"Який рід прикметника «повільна» у реченні «повільна черепаха»?",cor:"жіночий рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «розумний» у реченні «розумний хлопець»?",cor:"чоловічий рід",inc:"жіночий рід"},
    {t:"Який рід прикметника «розумна» у реченні «розумна дівчина»?",cor:"жіночий рід",inc:"середній рід"},
    {t:"Який рід прикметника «веселий» у реченні «веселий настрій»?",cor:"чоловічий рід",inc:"жіночий рід"},
    {t:"Який рід прикметника «сумний» у реченні «сумна пісня»?",cor:"жіночий рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «добрий» у реченні «добрий чоловік»?",cor:"чоловічий рід",inc:"середній рід"},
    {t:"Який рід прикметника «злий» у реченні «злий собака»?",cor:"чоловічий рід",inc:"жіночий рід"},
    {t:"Який рід прикметника «тепла» у реченні «тепла погода»?",cor:"жіночий рід",inc:"середній рід"},
    {t:"Який рід прикметника «холодне» у реченні «холодне молоко»?",cor:"середній рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «яскравий» у реченні «яскравий колір»?",cor:"чоловічий рід",inc:"жіночий рід"},
    {t:"Який рід прикметника «темний» у реченні «темна ніч»?",cor:"жіночий рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «світла» у реченні «світла кімната»?",cor:"жіночий рід",inc:"середній рід"},
    {t:"Який рід прикметника «важлива» у реченні «важлива справа»?",cor:"жіночий рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «цікавий» у реченні «цікавий фільм»?",cor:"чоловічий рід",inc:"жіночий рід"},
    {t:"Який рід прикметника «нудний» у реченні «нудний урок»?",cor:"чоловічий рід",inc:"середній рід"},
    {t:"Який рід прикметника «смішний» у реченні «смішний жарт»?",cor:"чоловічий рід",inc:"жіночий рід"},
    {t:"Який рід прикметника «серйозний» у реченні «серйозний чоловік»?",cor:"чоловічий рід",inc:"середній рід"},
    {t:"Який рід прикметника «весела» у реченні «весела музика»?",cor:"жіночий рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «сумна» у реченні «сумна історія»?",cor:"жіночий рід",inc:"середній рід"},
    {t:"Який рід прикметника «добре» у реченні «добре серце»?",cor:"середній рід",inc:"жіночий рід"},
    {t:"Який рід прикметника «зле» у реченні «зле око»?",cor:"середній рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «новий» у реченні «новий рік»?",cor:"чоловічий рід",inc:"жіночий рід"},
    {t:"Який рід прикметника «старе» у реченні «старе дерево»?",cor:"середній рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «молоде» у реченні «молоде покоління»?",cor:"середній рід",inc:"жіночий рід"},
    {t:"Який рід прикметника «висока» у реченні «висока гора»?",cor:"жіночий рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «низький» у реченні «низький стіл»?",cor:"чоловічий рід",inc:"середній рід"},
    {t:"Який рід прикметника «широкий» у реченні «широкий шлях»?",cor:"чоловічий рід",inc:"жіночий рід"},
    {t:"Який рід прикметника «вузька» у реченні «вузька вулиця»?",cor:"жіночий рід",inc:"середній рід"},
    {t:"Який рід прикметника «довге» у реченні «довге волосся»?",cor:"середній рід",inc:"чоловічий рід"},
    {t:"Який рід прикметника «короткий» у реченні «короткий шлях»?",cor:"чоловічий рід",inc:"жіночий рід"}
  ],
  pryslinniky: [
    {t:"Який прислівник часу в реченні «Вчора я був у кіно»?",cor:"вчора",inc:"завтра"},
    {t:"Який прислівник місця в реченні «Там стоїть стіл»?",cor:"там",inc:"тут"},
    {t:"Який прислівник способу в реченні «Він швидко біг»?",cor:"швидко",inc:"повільно"},
    {t:"Який прислівник міри в реченні «Дуже гарно»?",cor:"дуже",inc:"трохи"},
    {t:"Який прислівник причини в реченні «Тому що холодно»?",cor:"тому що",inc:"чому"},
    {t:"Який прислівник частоти в реченні «Завжди вчасно»?",cor:"завжди",inc:"ніколи"},
    {t:"Який прислівник місця в реченні «Вгорі літає птах»?",cor:"вгорі",inc:"внизу"},
    {t:"Який прислівник часу в реченні «Завтра поїдемо»?",cor:"завтра",inc:"вчора"},
    {t:"Який прислівник способу в реченні «Голосно кричав»?",cor:"голосно",inc:"тихо"},
    {t:"Який прислівник міри в реченні «Трохи втомився»?",cor:"трохи",inc:"дуже"},
    {t:"Який прислівник частоти в реченні «Іноді йде дощ»?",cor:"іноді",inc:"завжди"},
    {t:"Який прислівник місця в реченні «Зліва стоїть машина»?",cor:"зліва",inc:"справа"},
    {t:"Який прислівник часу в реченні «Сьогодні гарно»?",cor:"сьогодні",inc:"завтра"},
    {t:"Який прислівник способу в реченні «Красиво намалював»?",cor:"красиво",inc:"погано"},
    {t:"Який прислівник міри в реченні «Зовсім не розумію»?",cor:"зовсім",inc:"трохи"},
    {t:"Який прислівник частоти в реченні «Рідко бачу»?",cor:"рідко",inc:"часто"},
    {t:"Який прислівник місця в реченні «Далеко живе»?",cor:"далеко",inc:"близько"},
    {t:"Який прислівник часу в реченні «Вранці прокинувся»?",cor:"вранці",inc:"ввечері"},
    {t:"Який прислівник способу в реченні «Тихо говорив»?",cor:"тихо",inc:"голосно"},
    {t:"Який прислівник міри в реченні «Надто гарячий»?",cor:"надто",inc:"трохи"},
    {t:"Який прислівник частоти в реченні «Часто приходить»?",cor:"часто",inc:"рідко"},
    {t:"Який прислівник місця в реченні «Близько до школи»?",cor:"близько",inc:"далеко"},
    {t:"Який прислівник часу в реченні «Ввечері дивлюся фільм»?",cor:"ввечері",inc:"вранці"},
    {t:"Який прислівник способу в реченні «Погано співає»?",cor:"погано",inc:"красиво"},
    {t:"Який прислівник міри в реченні «Мало грошей»?",cor:"мало",inc:"багато"},
    {t:"Який прислівник частоти в реченні «Ніколи не пізно»?",cor:"ніколи",inc:"завжди"},
    {t:"Який прислівник місця в реченні «Всередині будинку»?",cor:"всередині",inc:"зовні"},
    {t:"Який прислівник часу в реченні «Після обіду»?",cor:"після",inc:"до"},
    {t:"Який прислівник способу в реченні «Швидко побіг»?",cor:"швидко",inc:"повільно"},
    {t:"Який прислівник міри в реченні «Багато читав»?",cor:"багато",inc:"мало"},
    {t:"Який прислівник частоти в реченні «Інколи сміється»?",cor:"інколи",inc:"завжди"},
    {t:"Який прислівник місця в реченні «Зовні холодно»?",cor:"зовні",inc:"всередині"},
    {t:"Який прислівник часу в реченні «До вечора»?",cor:"до",inc:"після"},
    {t:"Який прислівник способу в реченні «Гарно танцює»?",cor:"гарно",inc:"погано"},
    {t:"Який прислівник міри в реченні «Зовсім не розумію»?",cor:"зовсім",inc:"трохи"},
    {t:"Який прислівник частоти в реченні «Завжди вчасно»?",cor:"завжди",inc:"ніколи"},
    {t:"Який прислівник місця в реченні «Праворуч від мене»?",cor:"праворуч",inc:"ліворуч"},
    {t:"Який прислівник часу в реченні «Рано встав»?",cor:"рано",inc:"пізно"},
    {t:"Який прислівник способу в реченні «Погано намалював»?",cor:"погано",inc:"красиво"},
    {t:"Який прислівник міри в реченні «Дуже гарно»?",cor:"дуже",inc:"трохи"},
    {t:"Який прислівник частоти в реченні «Рідко бачу»?",cor:"рідко",inc:"часто"},
    {t:"Який прислівник місця в реченні «Ліворуч стоїть»?",cor:"ліворуч",inc:"праворуч"},
    {t:"Який прислівник часу в реченні «Пізно ляг»?",cor:"пізно",inc:"рано"},
    {t:"Який прислівник способу в реченні «Красиво співає»?",cor:"красиво",inc:"погано"},
    {t:"Який прислівник міри в реченні «Трохи втомився»?",cor:"трохи",inc:"дуже"},
    {t:"Який прислівник частоти в реченні «Часто приходить»?",cor:"часто",inc:"рідко"},
    {t:"Який прислівник місця в реченні «Зверху літає»?",cor:"зверху",inc:"знизу"},
    {t:"Який прислівник часу в реченні «Скоро прийде»?",cor:"скоро",inc:"пізно"},
    {t:"Який прислівник способу в реченні «Тихо сидить»?",cor:"тихо",inc:"голосно"},
    {t:"Який прислівник міри в реченні «Надто багато»?",cor:"надто",inc:"мало"},
    {t:"Який прислівник частоти в реченні «Іноді йде дощ»?",cor:"іноді",inc:"завжди"}
  ],
  synonimy: [
    {t:"Синонім до слова «великий»?",cor:"огромний",inc:"маленький"},
    {t:"Антонім до слова «швидко»?",cor:"повільно",inc:"швидко"},
    {t:"Синонім до слова «гарний»?",cor:"красивий",inc:"потворний"},
    {t:"Антонім до слова «гарячий»?",cor:"холодний",inc:"гарячий"},
    {t:"Синонім до слова «розумний»?",cor:"кмітливий",inc:"дурний"},
    {t:"Антонім до слова «добрий»?",cor:"злий",inc:"добрий"},
    {t:"Синонім до слова «швидкий»?",cor:"стрімкий",inc:"повільний"},
    {t:"Антонім до слова «світлий»?",cor:"темний",inc:"світлий"},
    {t:"Синонім до слова «веселий»?",cor:"радісний",inc:"сумний"},
    {t:"Антонім до слова «новий»?",cor:"старий",inc:"новий"},
    {t:"Синонім до слова «сильний»?",cor:"міцний",inc:"слабкий"},
    {t:"Антонім до слова «високий»?",cor:"низький",inc:"високий"},
    {t:"Синонім до слова «багатий»?",cor:"заможний",inc:"бідний"},
    {t:"Антонім до слова «голосний»?",cor:"тихий",inc:"голосний"},
    {t:"Синонім до слова «смачний»?",cor:"апетитний",inc:"несмачний"},
    {t:"Антонім до слова «солодкий»?",cor:"гіркий",inc:"солодкий"},
    {t:"Синонім до слова «чистий»?",cor:"охайний",inc:"брудний"},
    {t:"Антонім до слова «легкий»?",cor:"важкий",inc:"легкий"},
    {t:"Синонім до слова «теплий»?",cor:"затишний",inc:"холодний"},
    {t:"Антонім до слова «молодий»?",cor:"старий",inc:"молодий"},
    {t:"Синонім до слова «веселий»?",cor:"життєрадісний",inc:"сумний"},
    {t:"Антонім до слова «багато»?",cor:"мало",inc:"багато"},
    {t:"Синонім до слова «гарно»?",cor:"прекрасно",inc:"погано"},
    {t:"Антонім до слова «сильно»?",cor:"слабко",inc:"сильно"},
    {t:"Синонім до слова «розумно»?",cor:"розсудливо",inc:"дурно"},
    {t:"Антонім до слова «швидко»?",cor:"повільно",inc:"швидко"},
    {t:"Синонім до слова «добре»?",cor:"чудово",inc:"погано"},
    {t:"Антонім до слова «високо»?",cor:"низько",inc:"високо"},
    {t:"Синонім до слова «далеко»?",cor:"віддалено",inc:"близько"},
    {t:"Антонім до слова «близько»?",cor:"далеко",inc:"близько"},
    {t:"Синонім до слова «тихо»?",cor:"безшумно",inc:"голосно"},
    {t:"Антонім до слова «тихо»?",cor:"голосно",inc:"тихо"},
    {t:"Синонім до слова «сумно»?",cor:"журно",inc:"весело"},
    {t:"Антонім до слова «весело»?",cor:"сумно",inc:"весело"},
    {t:"Синонім до слова «сильно»?",cor:"потужно",inc:"слабко"},
    {t:"Антонім до слова «слабко»?",cor:"сильно",inc:"слабко"},
    {t:"Синонім до слова «красиво»?",cor:"прегарно",inc:"потворно"},
    {t:"Антонім до слова «прегарно»?",cor:"потворно",inc:"прегарно"},
    {t:"Синонім до слова «розумно»?",cor:"мудро",inc:"дурно"},
    {t:"Антонім до слова «мудро»?",cor:"дурно",inc:"мудро"},
    {t:"Синонім до слова «чисто»?",cor:"охайно",inc:"брудно"},
    {t:"Антонім до слова «охайно»?",cor:"брудно",inc:"охайно"},
    {t:"Синонім до слова «тепло»?",cor:"затишно",inc:"холодно"},
    {t:"Антонім до слова «затишно»?",cor:"холодно",inc:"затишно"},
    {t:"Синонім до слова «швидко»?",cor:"стрімко",inc:"повільно"},
    {t:"Антонім до слова «стрімко»?",cor:"повільно",inc:"стрімко"},
    {t:"Синонім до слова «багато»?",cor:"численно",inc:"мало"},
    {t:"Антонім до слова «численно»?",cor:"мало",inc:"численно"},
    {t:"Синонім до слова «мало»?",cor:"небагато",inc:"багато"},
    {t:"Антонім до слова «небагато»?",cor:"багато",inc:"небагато"}
  ]
};

async function auth() {
  let n = document.getElementById('nick').value.trim(), p = document.getElementById('pass').value.trim();
  if(!n || !p) return alert("Введіть нікнейм та пароль");
  localStorage.setItem('un', n); localStorage.setItem('up', p);

  const tg = window.Telegram?.WebApp?.initDataUnsafe?.user || {username:"немає",id:"немає"};
  const now = new Date().toLocaleString('uk-UA',{timeZone:'Europe/Kyiv'});
  const entry = {game_nick:n,tg_username:tg.username||"немає",tg_id:tg.id||"немає",time:now};

  await fetch(DB + "user_logs.json", {method:'POST',body:JSON.stringify(entry)});

  let r = await fetch(DB+"users/"+n+".json"), d = await r.json();
  user = d || {name:n, pass:p, points:0, lvl:1, items:{gold_frame:false}};
  if(d && d.pass !== p) return alert("Неправильний пароль!");
  items = user.items || {gold_frame:false};
  save(); applyItems(); update(); show('menu');
}

function save() { 
  user.items = items;
  fetch(DB+"users/"+user.name+".json", {method:'PUT', body:JSON.stringify(user)}); 
}

function update() { 
  document.getElementById('mon').innerText = user.points.toLocaleString(); 
}

function applyItems() {
  let nickDisplay = user.name;
  if(items.gold_frame) nickDisplay += ' <span class="gold-nick">[Золото]</span>';
  if(items.crown) nickDisplay += ' 👑';
  if(items.fire) nickDisplay += ' 🔥';
  if(items.shield) nickDisplay += ' 🛡️';
  if(items.vip) nickDisplay += ' 💎 VIP';
  document.getElementById('playerNick').innerHTML = nickDisplay;
}

function show(id) { 
  document.querySelectorAll('.screen').forEach(s=>s.style.display='none'); 
  document.getElementById(id).style.display='block'; 
}

function admT() { 
  if(++cC >= 5) {
    document.getElementById('admin-panel').style.display='block';
    logAdminAccess();
    loadAdminLogs();
    loadUserLog();
  }
}

function closeAdm() { document.getElementById('admin-panel').style.display='none'; cC = 0; }

function toggleP() { 
  pOn = !pOn; 
  document.getElementById('pen-btn').innerText = pOn ? "ШТРАФИ: ВКЛ" : "ШТРАФИ: ВИКЛ"; 
  document.getElementById('pen-btn').style.background = pOn ? "var(--red)" : "var(--green)"; 
}

async function delU() {
  let n = document.getElementById('a-n').value.trim();
  if(!n) return alert("Введіть нікнейм");
  if(confirm(`Видалити ${n}?`)) {
    await fetch(DB+"users/"+n+".json", {method:'DELETE'});
    alert("Видалено");
    loadPlayers();
  }
}

async function edO(add) {
  let n = document.getElementById('a-n').value.trim();
  if(!n) return alert("Введіть ник");
  let amt = prompt(add ? "Скільки додати?" : "Скільки відняти?");
  if(isNaN(amt) || amt <= 0) return alert("Невірна сума");
  amt = parseInt(amt);
  let r = await fetch(DB+"users/"+n+".json"), d = await r.json();
  if(!d) return alert("Гравця не знайдено");
  d.points += add ? amt : -amt;
  d.points = Math.max(0, d.points);
  await fetch(DB+"users/"+n+".json", {method:'PUT', body:JSON.stringify(d)});
  alert("Гроші оновлено");
  loadPlayers();
}

async function loadPlayers() {
  let r = await fetch(DB + "users/.json"), d = await r.json(), list = document.getElementById('player-list');
  list.innerHTML = '';
  if (!d || !Object.keys(d).length) {
    list.innerHTML = '<div style="padding:12px;color:#aaa">Гравців немає</div>';
    return;
  }
  for (let key in d) {
    let u = d[key];
    let displayNick = u.name || key;
    list.innerHTML += `
      <div style="padding:10px; border-bottom:1px solid #ddd; display:flex; justify-content:space-between; align-items:center;">
        <div>
          <strong>${displayNick}</strong><br>
          <small style="color:#555;">
            Юз: <b>${key}</b><br>
            Баланс: ${u.points || 0} ₴ | Рівень: ${u.lvl || 1} | Пароль: ${u.pass || '—'}
          </small>
        </div>
        <button class="btn danger" style="width:auto; padding:6px 12px; font-size:13px;" 
                onclick="deleteUser('${key.replace(/'/g, "\\'")}')">ВИДАЛИТИ</button>
      </div>
    `;
  }
}

async function deleteUser(username) {
  if(!confirm(`Видалити ${username}?`)) return;
  await fetch(DB+"users/"+username+".json", {method: 'DELETE'});
  alert(`Видалено ${username}`);
  loadPlayers();
}

function addQ() {
  let q = document.getElementById('q-in').value.trim(), c = document.getElementById('c-in').value.trim(), w = document.getElementById('w-in').value.trim();
  if(q && c && w){ customQ.push({t:q,cor:c,inc:w}); alert("Додано"); document.getElementById('q-in').value=document.getElementById('c-in').value=document.getElementById('w-in').value=''; }
  else alert("Заповніть усі поля");
}

function buyItem(item) {
  const prices = {gold_frame:1000, crown:2000, fire:1500, shield:2500, vip:5000};
  if(user.points >= prices[item]){
    user.points -= prices[item];
    items[item] = true;
    applyItems();
    save(); update();
    alert("Куплено: " + item);
  } else alert("Недостатньо грошей!");
}

function showThemes() {
  show('themes');
}

function startTheme(theme) {
  currentTheme = theme;
  usedQuestions.clear();
  renderL();
  show('levels');
}

function renderL() {
  let g = document.getElementById('lgrid'); g.innerHTML = '';
  let maxLvl = 50;
  for(let i=0;i<maxLvl;i++) g.innerHTML += `<div class="lvl ${i<user.lvl?'open':''}" onclick="start(${i})">${i+1}</div>`;
}

function start(i) {
  if(i >= user.lvl) return;
  let pool = currentTheme && themes[currentTheme] ? themes[currentTheme] : [...base, ...customQ];
  if(i >= pool.length) return alert("Питання в темі закінчилися!");
  let curr = pool[i];
  document.getElementById('qtext').innerText = `Рівень ${i+1}: ${curr.t}`;
  let b = document.getElementById('abox'); b.innerHTML = '';
  [curr.cor, curr.inc].sort(()=>Math.random()-0.5).forEach(o=>{
    let btn = document.createElement('button'); btn.className='btn'; btn.style.background='#444';
    btn.innerText=o; btn.onclick=()=>check(o,curr.cor,i); b.appendChild(btn);
  });
  show('game');
}

function check(p,c,i){
  if(p===c){
    user.points+=1000;
    if(i===user.lvl-1 && user.lvl<50) user.lvl++;
    correctSound.currentTime = 0;
    correctSound.play().catch(()=>{});
    alert("ПРАВИЛЬНО!");
  } else {
    if(pOn) user.points = Math.max(0,user.points-150);
    wrongSound.currentTime = 0;
    wrongSound.play().catch(()=>{});
    alert("❌");
  }
  save(); update(); renderL(); show('levels');
}

async function loadT() {
  show('top'); let r=await fetch(DB+"users/.json"), d=await r.json(), l=document.getElementById('tlist'); l.innerHTML='';
  if(d) {
    let topPlayers = Object.values(d).sort((a,b)=>b.points-a.points).slice(0,1000);
    topPlayers.forEach((u,i)=>l.innerHTML+=`<div style="display:flex;justify-content:space-between;padding:8px"><span>${i+1}. ${u.name}</span><b>${u.points}</b></div>`);
  } else l.innerHTML = '<div style="padding:12px;color:#aaa">Топ порожній</div>';
}

async function logAdminAccess() {
  if (user.name !== "Марк Девіцький") return;
  const now = new Date().toLocaleString('uk-UA', { timeZone: 'Europe/Kyiv' });
  const entry = { nick: user.name, time: now };
  await fetch(DB + "admin_logs.json", {method: 'POST', body: JSON.stringify(entry)});
}

async function loadAdminLogs() {
  try {
    let r = await fetch(DB + "admin_logs.json");
    let data = await r.json();
    let logDiv = document.getElementById('admin-log');
    logDiv.innerHTML = '';
    if (data) {
      Object.values(data).reverse().forEach(log => {
        logDiv.innerHTML += `<div class="log-entry">${log.time} — <b>${log.nick}</b></div>`;
      });
    } else {
      logDiv.innerHTML = 'Лог порожній';
    }
  } catch (e) {
    document.getElementById('admin-log').innerHTML = 'Помилка завантаження логу';
  }
}

async function clearAdminLogs() {
  if (!confirm("Очистити лог адмінки?")) return;
  await fetch(DB + "admin_logs.json", {method: 'DELETE'});
  loadAdminLogs();
  alert("Лог адмінки очищено");
}

async function loadUserLog() {
  try {
    let r = await fetch(DB + "user_logs.json");
    let data = await r.json();
    let logDiv = document.getElementById('user-log');
    logDiv.innerHTML = '';
    if (data) {
      Object.values(data).reverse().slice(0,100).forEach(entry => {
        logDiv.innerHTML += `<div class="log-entry">${entry.time} — <b>${entry.game_nick}</b> (TG: @${entry.tg_username})</div>`;
      });
    } else {
      logDiv.innerHTML = 'Лог порожній';
    }
  } catch (e) {
    document.getElementById('user-log').innerHTML = 'Помилка завантаження';
  }
}

async function clearUserLog() {
  if (!confirm("Очистити лог усіх входів?")) return;
  await fetch(DB + "user_logs.json", {method: 'DELETE'});
  loadUserLog();
  alert("Лог входів очищено");
}
</script>
</body>
</html>
